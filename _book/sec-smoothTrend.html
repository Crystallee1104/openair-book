<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 15 Smooth trends | openair</title>
  <meta name="description" content="This will eventually form a book related to the openair R package." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 15 Smooth trends | openair" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This will eventually form a book related to the openair R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 15 Smooth trends | openair" />
  
  <meta name="twitter:description" content="This will eventually form a book related to the openair R package." />
  

<meta name="author" content="David Carslaw" />


<meta name="date" content="2020-07-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-TheilSen.html"/>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>3</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>3.1</b> Accessing data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>3.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="3.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>3.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>4</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>4.1</b> The <code>worldmet</code> package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>5</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>5.1</b> Example of use</a></li>
<li class="chapter" data-level="5.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>5.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>6</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>6.2</b> Examples</a></li>
<li class="chapter" data-level="6.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>6.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>7</b> Polar plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>7.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="7.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>7.2</b> Examples</a></li>
<li class="chapter" data-level="7.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>7.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="7.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>7.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="7.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>7.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="7.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>7.6</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>8</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>8.1</b> Purpose</a></li>
<li class="chapter" data-level="8.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>8.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>9</b> Time series plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>9.1</b> Background</a></li>
<li class="chapter" data-level="9.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>9.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>10</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>10.1</b> Purpose</a></li>
<li class="chapter" data-level="10.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>10.2</b> Applications</a></li>
<li class="chapter" data-level="10.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>10.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>11</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>11.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>12</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>12.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="12.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>12.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>13</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>13.1</b> Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>13.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>14</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>14.1</b> Trend estimates</a></li>
<li class="chapter" data-level="14.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>14.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>14.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>15</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>15.1</b> Background</a></li>
<li class="chapter" data-level="15.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>15.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="15.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>15.3</b> Seasonal averages</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">openair</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:smoothTrend" class="section level1" number="15">
<h1><span class="header-section-number">Section 15</span> Smooth trends</h1>
<div id="sec:SmoothTrendInfo" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Background</h2>
<p>The <code>smoothTrend</code> function calculates smooth trends in the
monthly mean concentrations of pollutants. In its basic use it will
generate a plot of monthly concentrations and fit a smooth line to the
data and show the 95% confidence intervals of the fit. The smooth
line is essentially determined using Generalized Additive Modelling
using the <span class="pkg">mgcv</span> package. This package provides a comprehensive
and powerful set of methods for modelling data. In this case, however,
the <em>model</em> is a relationship between time and pollutant
concentration i.e. a trend. One of the principal advantages of this
approach is that the amount of smoothness in the trend is optimised in
the sense that it is neither too smooth (therefore missing important
features) nor too variable (perhaps fitting ‘noise’ rather than real
effects). Some background information on the use of this approach in
an air quality setting can be found in <span class="citation">Carslaw, Beevers, and Tate (<a href="#ref-Carslaw2007a" role="doc-biblioref">2007</a>)</span>.</p>
<p>Section <a href="#sec:trends-gam"><strong>??</strong></a> considers smooth trends in more detail and
considers how different models can be developed that can be quite
sophisticated. Readers should consider this section if they are
considering trend analysis in more depth.</p>
<p>The user can select to deseasonalise the data first to provide a
clearer indication of the overall trend on a monthly basis. The data
are deseasonalised using the <code>stl</code> function. The user may also
select to use bootstrap simulations to provide an alternative method
of estimating the uncertainties in the trend. In addition, the
simulated estimates of uncertainty can account for autocorrelation in
the residuals using a block bootstrap approach.</p>
</div>
<div id="examples-of-trend-analysis" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Examples of trend analysis</h2>
<p>We apply the function to concentrations of O<sub>3</sub> and NO<sub>2</sub> using the
code below. The first plot shows the smooth trend in raw O<sub>3</sub>
concentrations, which shows a very clear seasonal cycle. By removing
the seasonal cycle of O<sub>3</sub>, a better indication of the trend is
given, shown in the second plot. Removing the seasonal cycle is more
effective for pollutants (or locations) where the seasonal cycle is
stronger e.g. for ozone and background
sites. Figure #ref(fig:smoothTrends) shows the results of the simulations
for NO<sub>2</sub> without the seasonal cycle removed. It is clear from this
plot that there is little evidence of a seasonal cycle. The principal
advantage of the smoothing approach compared with the Theil-Sen method
is also clearly shown in this plot. Concentrations of NO<sub>2</sub> first
decrease, then increase strongly. The trend is therefore not
monotonic, violating the Theil-Sen assumptions. Finally, the last plot
shows the effects of first deaseasonalising the data: in this case
with little effect.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sec-smoothTrend.html#cb127-1" aria-hidden="true"></a><span class="kw">smoothTrend</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;concentration (ppb)&quot;</span>,</span>
<span id="cb127-2"><a href="sec-smoothTrend.html#cb127-2" aria-hidden="true"></a>            <span class="dt">main =</span> <span class="st">&quot;monthly mean o3&quot;</span>)</span>
<span id="cb127-3"><a href="sec-smoothTrend.html#cb127-3" aria-hidden="true"></a></span>
<span id="cb127-4"><a href="sec-smoothTrend.html#cb127-4" aria-hidden="true"></a><span class="kw">smoothTrend</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">deseason =</span> <span class="ot">TRUE</span>, <span class="dt">ylab =</span> <span class="st">&quot;concentration (ppb)&quot;</span>,</span>
<span id="cb127-5"><a href="sec-smoothTrend.html#cb127-5" aria-hidden="true"></a>            <span class="dt">main =</span> <span class="st">&quot;monthly mean deseasonalised o3&quot;</span>)</span>
<span id="cb127-6"><a href="sec-smoothTrend.html#cb127-6" aria-hidden="true"></a></span>
<span id="cb127-7"><a href="sec-smoothTrend.html#cb127-7" aria-hidden="true"></a><span class="kw">smoothTrend</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">simulate =</span> <span class="ot">TRUE</span>, <span class="dt">ylab =</span> <span class="st">&quot;concentration (ppb)&quot;</span>,</span>
<span id="cb127-8"><a href="sec-smoothTrend.html#cb127-8" aria-hidden="true"></a>            <span class="dt">main =</span> <span class="st">&quot;monthly mean no2 (bootstrap uncertainties)&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Taking bootstrap samples. Please wait...&quot;</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sec-smoothTrend.html#cb129-1" aria-hidden="true"></a><span class="kw">smoothTrend</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">deseason =</span> <span class="ot">TRUE</span>, <span class="dt">simulate =</span><span class="ot">TRUE</span>,</span>
<span id="cb129-2"><a href="sec-smoothTrend.html#cb129-2" aria-hidden="true"></a>            <span class="dt">ylab =</span> <span class="st">&quot;concentration (ppb)&quot;</span>,</span>
<span id="cb129-3"><a href="sec-smoothTrend.html#cb129-3" aria-hidden="true"></a>            <span class="dt">main =</span> <span class="st">&quot;monthly mean deseasonalised no2 (bootstrap uncertainties)&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Taking bootstrap samples. Please wait...&quot;</code></pre>
<div class="figure"><span id="fig:smoothTrendComp"></span>
<img src="openair_files/figure-html/smoothTrendComp-1.png" alt="Examples of the `smoothTrend` function applied to    Marylebone Road" width="50%" /><img src="openair_files/figure-html/smoothTrendComp-2.png" alt="Examples of the `smoothTrend` function applied to    Marylebone Road" width="50%" /><img src="openair_files/figure-html/smoothTrendComp-3.png" alt="Examples of the `smoothTrend` function applied to    Marylebone Road" width="50%" /><img src="openair_files/figure-html/smoothTrendComp-4.png" alt="Examples of the `smoothTrend` function applied to    Marylebone Road" width="50%" />
<p class="caption">
Figure 15.1: Examples of the <code>smoothTrend</code> function applied to Marylebone Road
</p>
</div>
<p>The <code>smoothTrend</code> function share many of the functionalities of
the <code>TheilSen</code> function. Figure <a href="sec-smoothTrend.html#fig:smoothwd">15.2</a> shows the
result of applying this function to O<sub>3</sub> concentrations. The code
that produced Figure <a href="sec-smoothTrend.html#fig:smoothwd">15.2</a> was:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sec-smoothTrend.html#cb131-1" aria-hidden="true"></a><span class="kw">smoothTrend</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">deseason =</span> <span class="ot">TRUE</span>,</span>
<span id="cb131-2"><a href="sec-smoothTrend.html#cb131-2" aria-hidden="true"></a>             <span class="dt">type =</span> <span class="st">&quot;wd&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:smoothwd"></span>
<img src="openair_files/figure-html/smoothwd-1.png" alt="Trends in O~3~ using the `smoothTrend` function applied to Marylebone Road. The shading shows the estimated 95% confidence intervals." width="960" />
<p class="caption">
Figure 15.2: Trends in O<sub>3</sub> using the <code>smoothTrend</code> function applied to Marylebone Road. The shading shows the estimated 95% confidence intervals.
</p>
</div>
<p>The <code>smoothTrend</code> function can easily be used to gain a large
amount of information on trends easily. For example, how do trends in
NO<sub>2</sub>, O<sub>3</sub> and PM<sub>10</sub> vary by season and wind sector. There are 8
wind sectors and four seasons i.e. 32 plots. In Figure
<a href="sec-smoothTrend.html#fig:smoothwdSeason">15.3</a> all three pollutants are chosen and two
types (season and wind direction). We also reduce the number of axis
labels and the line to improve clarity. There are numerous
combinations of analyses that could be produced here and it is very
easy to explore the data in a wide number of ways.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="sec-smoothTrend.html#cb132-1" aria-hidden="true"></a><span class="kw">smoothTrend</span>(mydata, <span class="dt">pollutant =</span> <span class="kw">c</span>(<span class="st">&quot;no2&quot;</span>, <span class="st">&quot;pm10&quot;</span>, <span class="st">&quot;o3&quot;</span>), </span>
<span id="cb132-2"><a href="sec-smoothTrend.html#cb132-2" aria-hidden="true"></a>            <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;wd&quot;</span>, <span class="st">&quot;season&quot;</span>),</span>
<span id="cb132-3"><a href="sec-smoothTrend.html#cb132-3" aria-hidden="true"></a>            <span class="dt">date.breaks =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="figure"><span id="fig:smoothwdSeason"></span>
<img src="openair_files/figure-html/smoothwdSeason-1.png" alt="The `smoothTrend` function applied to three pollutants,  split by wind sector and season." width="1344" />
<p class="caption">
Figure 15.3: The <code>smoothTrend</code> function applied to three pollutants, split by wind sector and season.
</p>
</div>
</div>
<div id="seasonal-averages" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Seasonal averages</h2>
<p>If the interest is in considering seasonal trends, it makes sense to set the averaging time to ‘season’ and also show each season in a separate panel. In Figure <a href="sec-smoothTrend.html#fig:smoothTrendSeason">15.4</a> some data is imported for O<sub>3</sub> from Lullington Heath on the south coast of England. This plot shows there is strongest evidence for an increase in O<sub>3</sub> concentrations during springtime from about 2012 onwards. A probable reason for this increase is a general reduction in NO<sub>x</sub> concentrations.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="sec-smoothTrend.html#cb133-1" aria-hidden="true"></a>lh &lt;-<span class="st"> </span><span class="kw">importAURN</span>(<span class="dt">site =</span> <span class="st">&quot;lh&quot;</span>, <span class="dt">year =</span> <span class="dv">2000</span><span class="op">:</span><span class="dv">2019</span>)</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="sec-smoothTrend.html#cb134-1" aria-hidden="true"></a><span class="kw">smoothTrend</span>(lh, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>,</span>
<span id="cb134-2"><a href="sec-smoothTrend.html#cb134-2" aria-hidden="true"></a>            <span class="dt">avg.time =</span> <span class="st">&quot;season&quot;</span>,</span>
<span id="cb134-3"><a href="sec-smoothTrend.html#cb134-3" aria-hidden="true"></a>            <span class="dt">type =</span> <span class="st">&quot;season&quot;</span>,</span>
<span id="cb134-4"><a href="sec-smoothTrend.html#cb134-4" aria-hidden="true"></a>            <span class="dt">date.breaks =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure"><span id="fig:smoothTrendSeason"></span>
<img src="openair_files/figure-html/smoothTrendSeason-1.png" alt="Trends in O~3~ by season at the Lullington Heath site with a seasonal averaging time and panel for each season." width="576" />
<p class="caption">
Figure 15.4: Trends in O<sub>3</sub> by season at the Lullington Heath site with a seasonal averaging time and panel for each season.
</p>
</div>

<div id="refs" class="references hanging-indent">
<div>
<p>Applequist, Scott. 2012. “Wind Rose Bias Correction.” <em>Journal of Applied Meteorology and Climatology</em> 51 (7): 1305–9.</p>
</div>
<div>
<p>Ashbaugh, Lowell L., William C. Malm, and Willy Z. Sadeh. 1985. “A residence time probability analysis of sulfur concentrations at grand Canyon National Park.” <em>Atmospheric Environment (1967)</em> 19 (8): 1263–70. <a href="https://doi.org/10.1016/0004-6981(85)90256-2">https://doi.org/10.1016/0004-6981(85)90256-2</a>.</p>
</div>
<div>
<p>Carslaw, D. C., and S. D. Beevers. 2013. “Characterising and Understanding Emission Sources Using Bivariate Polar Plots and K-Means Clustering.” <em>Environmental Modelling &amp; Software</em> 40 (0): 325–29. <a href="https://doi.org/10.1016/j.envsoft.2012.09.005">https://doi.org/10.1016/j.envsoft.2012.09.005</a>.</p>
</div>
<div>
<p>Carslaw, D. C., S. D. Beevers, K. Ropkins, and M. C. Bell. 2006. “Detecting and Quantifying Aircraft and Other on-Airport Contributions to Ambient Nitrogen Oxides in the Vicinity of a Large International Airport.” <em>Atmospheric Environment</em> 40 (28): 5424–34.</p>
</div>
<div>
<p>Carslaw, D. C., S. D. Beevers, and J. E. Tate. 2007. “Modelling and Assessing Trends in Traffic-Related Emissions Using a Generalised Additive Modelling Approach.” <em>Atmospheric Environment</em> 41 (26): 5289–99.</p>
</div>
<div>
<p>COMEAP. 2011. “Review of the Uk Air Quality Index: A Report by the Committee on the Medical Effects of Air Pollutants.” <a href="http://comeap.org.uk/documents/reports/130-review-of-the-uk-air-quality-index.html">http://comeap.org.uk/documents/reports/130-review-of-the-uk-air-quality-index.html</a>.</p>
</div>
<div>
<p>Droppo, James G, and Bruce A Napier. 2008. “Wind Direction Bias in Generating Wind Roses and Conducting Sector-Based Air Dispersion Modeling.” <em>Journal of the Air &amp; Waste Management Association</em> 58 (7): 913–18.</p>
</div>
<div>
<p>Grange, Stuart K, Alastair C Lewis, and David C Carslaw. 2016. “Source Apportionment Advances Using Polar Plots of Bivariate Correlation and Regression Statistics.” <em>Atmospheric Environment</em> 145: 128–34.</p>
</div>
<div>
<p>Hastie, T. J., and R. J. Tibshirani. 1990. <em>Generalized Additive Models</em>. London: Chapman; Hall.</p>
</div>
<div>
<p>Henry, Ronald, Gary A. Norris, Ram Vedantham, and Jay R. Turner. 2009. “Source Region Identification Using Kernel Smoothing.” Article. <em>Environmental Science &amp; Technology</em> 43 (11): 4090–7. <a href="https://doi.org/%7B10.1021/es8011723%7D">https://doi.org/{10.1021/es8011723}</a>.</p>
</div>
<div>
<p>Hirsch, R. M., J. R. Slack, and R. A. Smith. 1982. “Techniques of Trend Analysis for Monthly Water-Quality Data.” <em>Water Resources Research</em> 18 (1): 107–21.</p>
</div>
<div>
<p>Kunsch, H. R. 1989. “The Jackknife and the Bootstrap for General Stationary Observations.” <em>Annals of Statistics</em> 17 (3): 1217–41.</p>
</div>
<div>
<p>Sen, P. K. 1968. “Estimates of Regression Coefficient Based on Kendall’s Tau.” <em>Journal of the American Statistical Association</em> 63(324): 1379–89.</p>
</div>
<div>
<p>Theil, H. 1950. “A Rank Invariant Method of Linear and Polynomial Regression Analysis, I, Ii, Iii.” <em>Proceedings of the Koninklijke Nederlandse Akademie Wetenschappen, Series A – Mathematical Sciences</em> 53: 386–92, 521–25, 1397–1412.</p>
</div>
<div>
<p>Uria-Tellaetxe, I, and D. C. Carslaw. 2014. “Conditional Bivariate Probability Function for Source Identification.” <em>Environmental Modelling &amp; Software</em> 59: 1–9. <a href="https://doi.org/10.1016/j.envsoft.2014.05.002">https://doi.org/10.1016/j.envsoft.2014.05.002</a>.</p>
</div>
<div>
<p>Westmoreland, E. J., N Carslaw, D. C. Carslaw, A. Gillah, and E. Bates. 2007. “Analysis of Air Quality Within a Street Canyon Using Statistical and Dispersion Modelling Techniques.” <em>Atmospheric Environment</em> 41 (39): 9195–9205.</p>
</div>
<div>
<p>Wilcox, Rand R. 2010. <em>Fundamentals of Modern Statistical Methods: Substantially Improving Power and Accuracy</em>. 2nd ed. Springer New York. <a href="http://www.springerlink.com/content/978-1-4419-5524-1">http://www.springerlink.com/content/978-1-4419-5524-1</a>.</p>
</div>
<div>
<p>Wood, S. N. 2006. <em>Generalized Additive Models: An Introduction with R</em>. Chapman; Hall/CRC.</p>
</div>
<div>
<p>Xie, Yihui. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/">http://yihui.name/knitr/</a>.</p>
</div>
<div>
<p>———. 2020. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://CRAN.R-project.org/package=bookdown">https://CRAN.R-project.org/package=bookdown</a>.</p>
</div>
<div>
<p>Yu, K. N., Y. P. Cheung, T. Cheung, and R. C. Henry. 2004. “Identifying the Impact of Large Urban Airports on Local Air Quality by Nonparametric Regression.” <em>Atmospheric Environment</em> 38 (27): 4501–7.</p>
</div>
</div>
</div>
</div>











<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Carslaw2007a">
<p>Carslaw, D. C., S. D. Beevers, and J. E. Tate. 2007. “Modelling and Assessing Trends in Traffic-Related Emissions Using a Generalised Additive Modelling Approach.” <em>Atmospheric Environment</em> 41 (26): 5289–99.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-TheilSen.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/smooth-trend.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["openair.pdf", "openair.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
