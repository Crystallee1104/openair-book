<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section7 Polar frequencies | openair</title>
  <meta name="description" content="This will eventually form a book related to the openair R package." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section7 Polar frequencies | openair" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This will eventually form a book related to the openair R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section7 Polar frequencies | openair" />
  
  <meta name="twitter:description" content="This will eventually form a book related to the openair R package." />
  

<meta name="author" content="David Carslaw" />


<meta name="date" content="2020-07-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-windRose.html"/>
<link rel="next" href="sec-percentileRose.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hello</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="sec-openair-package.html"><a href="sec-openair-package.html"><i class="fa fa-check"></i><b>3</b> The openair package</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-openair-package.html"><a href="sec-openair-package.html#access-to-source-code"><i class="fa fa-check"></i><b>3.1</b> Access to source code</a></li>
<li class="chapter" data-level="3.2" data-path="sec-openair-package.html"><a href="sec-openair-package.html#input-data-requirements"><i class="fa fa-check"></i><b>3.2</b> Input data requirements</a></li>
<li class="chapter" data-level="3.3" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:brief-intr-open"><i class="fa fa-check"></i><b>3.3</b> Brief overview of <code>openair</code></a></li>
<li class="chapter" data-level="3.4" data-path="sec-openair-package.html"><a href="sec-openair-package.html#the-type-option"><i class="fa fa-check"></i><b>3.4</b> The <code>type</code> option</a></li>
<li class="chapter" data-level="3.5" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:font-size"><i class="fa fa-check"></i><b>3.5</b> Controlling font size</a></li>
<li class="chapter" data-level="3.6" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:colours"><i class="fa fa-check"></i><b>3.6</b> Using colours</a></li>
<li class="chapter" data-level="3.7" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:quickText"><i class="fa fa-check"></i><b>3.7</b> Automatic text formatting</a></li>
<li class="chapter" data-level="3.8" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:plotting-more-than"><i class="fa fa-check"></i><b>3.8</b> Multiple plots on a page</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>4</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>4.1</b> Accessing data</a></li>
<li class="chapter" data-level="4.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>4.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="4.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>4.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>5</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>5.1</b> The <code>worldmet</code> package</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>6</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>6.1</b> Example of use</a></li>
<li class="chapter" data-level="6.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>6.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html"><i class="fa fa-check"></i><b>7</b> Polar frequencies</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html#sec:polarFreqBack"><i class="fa fa-check"></i><b>7.1</b> Background and examples</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>8</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>8.2</b> Examples</a></li>
<li class="chapter" data-level="8.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>8.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>9</b> Polar plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>9.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="9.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>9.2</b> Examples</a></li>
<li class="chapter" data-level="9.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>9.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="9.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>9.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="9.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>9.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="9.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>9.6</b> Clustering</a></li>
<li class="chapter" data-level="9.7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plots-on-an-interactive-map"><i class="fa fa-check"></i><b>9.7</b> Polar plots on an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>10</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>10.1</b> Purpose</a></li>
<li class="chapter" data-level="10.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>10.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>11</b> Time series plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>11.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>12</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>12.1</b> Purpose</a></li>
<li class="chapter" data-level="12.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>12.2</b> Applications</a></li>
<li class="chapter" data-level="12.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>12.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>13</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>13.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>14</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>14.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="14.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>14.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html"><i class="fa fa-check"></i><b>15</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterPurpose"><i class="fa fa-check"></i><b>15.1</b> Purpose</a></li>
<li class="chapter" data-level="15.2" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterEx"><i class="fa fa-check"></i><b>15.2</b> Examples</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:hexbin"><i class="fa fa-check"></i><b>15.2.1</b> Hexaganol binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>16</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>16.1</b> Purpose</a></li>
<li class="chapter" data-level="16.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>16.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>17</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="17.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>17.1</b> Trend estimates</a></li>
<li class="chapter" data-level="17.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>17.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>17.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>18</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>18.1</b> Background</a></li>
<li class="chapter" data-level="18.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>18.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="18.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>18.3</b> Seasonal averages</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html"><i class="fa fa-check"></i><b>19</b> Trajectory analysis</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#plotting-trajectories"><i class="fa fa-check"></i><b>19.1</b> Plotting trajectories</a></li>
<li class="chapter" data-level="19.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajLevel"><i class="fa fa-check"></i><b>19.2</b> Trajectory gridded frequencies</a></li>
<li class="chapter" data-level="19.3" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#trajectory-source-contribution-functions"><i class="fa fa-check"></i><b>19.3</b> Trajectory source contribution functions</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#identifying-the-contribution-of-high-concentration-back-trajectories"><i class="fa fa-check"></i><b>19.3.1</b> Identifying the contribution of high concentration back trajectories</a></li>
<li class="chapter" data-level="19.3.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#allocating-trajectories-to-different-wind-sectors"><i class="fa fa-check"></i><b>19.3.2</b> Allocating trajectories to different wind sectors</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#potential-source-contribution-function-pscf"><i class="fa fa-check"></i><b>19.4</b> Potential Source Contribution Function (PSCF)</a></li>
<li class="chapter" data-level="19.5" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#concentration-weighted-trajectory-cwt"><i class="fa fa-check"></i><b>19.5</b> Concentration Weighted Trajectory (CWT)</a></li>
<li class="chapter" data-level="19.6" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajCluster"><i class="fa fa-check"></i><b>19.6</b> Trajectory clustering</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html"><i class="fa fa-check"></i><b>20</b> Conditional quantiles</a>
<ul>
<li class="chapter" data-level="20.1" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalQuantileBack"><i class="fa fa-check"></i><b>20.1</b> Background</a></li>
<li class="chapter" data-level="20.2" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalEval"><i class="fa fa-check"></i><b>20.2</b> Conditional evaluation</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="sec-modStats.html"><a href="sec-modStats.html"><i class="fa fa-check"></i><b>21</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModBack"><i class="fa fa-check"></i><b>21.1</b> Background</a></li>
<li class="chapter" data-level="21.2" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModEx"><i class="fa fa-check"></i><b>21.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html"><i class="fa fa-check"></i><b>22</b> Taylor Diagam</a>
<ul>
<li class="chapter" data-level="22.1" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#sec:TaylorBack"><i class="fa fa-check"></i><b>22.1</b> Background</a></li>
<li class="chapter" data-level="22.2" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#examples-of-taylor-diagrams"><i class="fa fa-check"></i><b>22.2</b> Examples of Taylor Diagrams</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sec-utility.html"><a href="sec-utility.html"><i class="fa fa-check"></i><b>23</b> Utility functions</a>
<ul>
<li class="chapter" data-level="23.1" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectByDate"><i class="fa fa-check"></i><b>23.1</b> Selecting data by date</a></li>
<li class="chapter" data-level="23.2" data-path="sec-utility.html"><a href="sec-utility.html#sec:cutData"><i class="fa fa-check"></i><b>23.2</b> Making intervals — <code>cutData</code></a></li>
<li class="chapter" data-level="23.3" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectRunning"><i class="fa fa-check"></i><b>23.3</b> Selecting run lengths of values above a threshold — pollution episodes</a></li>
<li class="chapter" data-level="23.4" data-path="sec-utility.html"><a href="sec-utility.html#sec:rollingMean"><i class="fa fa-check"></i><b>23.4</b> Calculating rolling means</a></li>
<li class="chapter" data-level="23.5" data-path="sec-utility.html"><a href="sec-utility.html#sec:timeAverage"><i class="fa fa-check"></i><b>23.5</b> Aggregating data by different time intervals</a></li>
<li class="chapter" data-level="23.6" data-path="sec-utility.html"><a href="sec-utility.html#sec:calcPercentile"><i class="fa fa-check"></i><b>23.6</b> Calculating percentiles</a></li>
<li class="chapter" data-level="23.7" data-path="sec-utility.html"><a href="sec-utility.html#sec:corPlot"><i class="fa fa-check"></i><b>23.7</b> Correlation matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html"><i class="fa fa-check"></i><b>A</b> Annotating openair plots</a>
<ul>
<li class="chapter" data-level="A.1" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text"><i class="fa fa-check"></i><b>A.1</b> Adding text</a></li>
<li class="chapter" data-level="A.2" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text-and-a-shaded-area"><i class="fa fa-check"></i><b>A.2</b> Adding text and a shaded area</a></li>
<li class="chapter" data-level="A.3" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-an-arrow"><i class="fa fa-check"></i><b>A.3</b> Adding an arrow</a></li>
<li class="chapter" data-level="A.4" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-a-reference-line-and-text"><i class="fa fa-check"></i><b>A.4</b> Adding a reference line and text</a></li>
<li class="chapter" data-level="A.5" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#highlight-a-specific-point"><i class="fa fa-check"></i><b>A.5</b> Highlight a specific point</a></li>
<li class="chapter" data-level="A.6" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-a-filled-polygon"><i class="fa fa-check"></i><b>A.6</b> Add a filled polygon</a></li>
<li class="chapter" data-level="A.7" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-air-quality-bands-as-polygons"><i class="fa fa-check"></i><b>A.7</b> Add air quality bands as polygons</a></li>
<li class="chapter" data-level="A.8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>A.8</b> Polar plot examples</a></li>
<li class="chapter" data-level="A.9" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#using-grid-graphics-identify-locations-interactively"><i class="fa fa-check"></i><b>A.9</b> Using grid graphics — identify locations interactively</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">openair</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:polarFreq" class="section level1" number="7">
<h1><span class="header-section-number">Section7</span> Polar frequencies</h1>
<div id="sec:polarFreqBack" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Background and examples</h2>
<p>This compactly shows the distribution of wind
speeds and directions from meteorological measurements. It is similar
to the traditional wind rose, but includes a number of enhancements to
also show how concentrations of pollutants and other variables
vary. It can summarise all available data, or show it by different
time periods e.g. by year, month, day of the week. It can also
consider a wide range of statistics.</p>
<p>This section shows an example output and use, using our data frame
<code>mydata</code>. The function is very simply run as shown in Figure
<a href="sec-polarFreq.html#fig:polarFreqa">7.1</a>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sec-polarFreq.html#cb42-1" aria-hidden="true"></a><span class="kw">polarFreq</span>(mydata)</span></code></pre></div>
<div class="figure"><span id="fig:polarFreqa"></span>
<img src="openair_files/figure-html/polarFreqa-1.png" alt="Use of `polarFreq` function to plot wind speed/directions. Each cell gives the total number of hours the wind was from that wind speed/direction in a particular year. The number of hours is coded as a colour scale shown to the right. The scale itself is non-linear to help show the overall distribution. The dashed circular grey lines show the wind speed scale. The date range  covered by the data is shown in the strip." width="50%" />
<p class="caption">
Figure 7.1: Use of <code>polarFreq</code> function to plot wind speed/directions. Each cell gives the total number of hours the wind was from that wind speed/direction in a particular year. The number of hours is coded as a colour scale shown to the right. The scale itself is non-linear to help show the overall distribution. The dashed circular grey lines show the wind speed scale. The date range covered by the data is shown in the strip.
</p>
</div>
<p>By setting <code>type = "year"</code>, the frequencies are shown separately by
year as shown in Figure <a href="sec-polarFreq.html#fig:polarFreqYear">7.2</a>, which shows that most of the
time the wind is from a south-westerly direction with wind speeds most
commonly between 2–6 m s<sup>-1</sup>. In 2000 there seemed to be a lot of
conditions where the wind was from the south-west (leading to high
pollutant concentrations at this location). The data for 2003 also
stand out due to the relatively large number of occasions where the
wind was from the east. Note the default colour scale, which has had a
square-root transform applied, is used to provide a better visual
distribution of the data.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sec-polarFreq.html#cb43-1" aria-hidden="true"></a><span class="kw">polarFreq</span>(mydata, <span class="dt">type =</span> <span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:polarFreqYear"></span>
<img src="openair_files/figure-html/polarFreqYear-1.png" alt="Use of `polarFreq` function to plot wind speed/directions by year. Each cell gives the total number of hours the wind was from that wind speed/direction in a particular year. The number of hours is coded as a colour scale shown to the right. The scale itself is non-linear to help show the overall distribution. The dashed circular grey lines show the wind speed scale." width="768" />
<p class="caption">
Figure 7.2: Use of <code>polarFreq</code> function to plot wind speed/directions by year. Each cell gives the total number of hours the wind was from that wind speed/direction in a particular year. The number of hours is coded as a colour scale shown to the right. The scale itself is non-linear to help show the overall distribution. The dashed circular grey lines show the wind speed scale.
</p>
</div>
<p>The <code>polarFreq</code> function can also usefully consider pollutant
concentrations. Figure <a href="sec-polarFreq.html#fig:polarFreqMean">7.3</a> shows the mean
concentration of SO<sub>2</sub> by wind speed and wind direction and clearly
highlights that SO<sub>2</sub> concentrations tend to be highest for easterly
winds and for 1998 in particular.</p>
<p>By weighting the concentrations by the frequency of occasions the wind
is from a certain direction and has a certain speed, gives a better
indication of the conditions that dominate the overall mean
concentrations. Figure <a href="sec-polarFreq.html#fig:polarFreqWeightedMean">7.4</a> shows the weighted
mean concentration of SO<sub>2</sub> and highlights that annual mean
concentrations are dominated by south-westerly winds
i.e. contributions from the road itself — and not by the fewer higher
hours of concentrations when the wind is easterly. However, 2003 looks
interesting because for that year, significant contributions to the
overall mean were due to easterly wind conditions.</p>
<p>These plots when applied to other locations can reveal some useful
features about different sources. For example, it may be that the
highest concentrations measured only occur infrequently, and the
weighted mean plot can help show this.</p>
<p>The code required to make Figure <a href="sec-polarFreq.html#fig:polarFreqMean">7.3</a> and Figure
<a href="sec-polarFreq.html#fig:polarFreqWeightedMean">7.4</a> is shown below.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sec-polarFreq.html#cb44-1" aria-hidden="true"></a><span class="kw">polarFreq</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;so2&quot;</span>, </span>
<span id="cb44-2"><a href="sec-polarFreq.html#cb44-2" aria-hidden="true"></a>          <span class="dt">type =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb44-3"><a href="sec-polarFreq.html#cb44-3" aria-hidden="true"></a>           <span class="dt">statistic =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb44-4"><a href="sec-polarFreq.html#cb44-4" aria-hidden="true"></a>          <span class="dt">min.bin =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:polarFreqMean"></span>
<img src="openair_files/figure-html/polarFreqMean-1.png" alt="Use of `polarFre`} function to plot mean SO~2~ concentrations (ppb) by wind speed/directions and year." width="768" />
<p class="caption">
Figure 7.3: Use of <code>polarFre</code>} function to plot mean SO<sub>2</sub> concentrations (ppb) by wind speed/directions and year.
</p>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="sec-polarFreq.html#cb45-1" aria-hidden="true"></a><span class="co"># weighted mean SO2 concentrations</span></span>
<span id="cb45-2"><a href="sec-polarFreq.html#cb45-2" aria-hidden="true"></a><span class="kw">polarFreq</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;so2&quot;</span>, </span>
<span id="cb45-3"><a href="sec-polarFreq.html#cb45-3" aria-hidden="true"></a>          <span class="dt">type =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb45-4"><a href="sec-polarFreq.html#cb45-4" aria-hidden="true"></a>           <span class="dt">statistic =</span> <span class="st">&quot;weighted.mean&quot;</span>, </span>
<span id="cb45-5"><a href="sec-polarFreq.html#cb45-5" aria-hidden="true"></a>          <span class="dt">min.bin =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:polarFreqWeightedMean"></span>
<img src="openair_files/figure-html/polarFreqWeightedMean-1.png" alt="Use of `polarFreq} function to plot weighted mean SO~2~ concentrations (ppb) by wind speed/directions and year" width="768" />
<p class="caption">
Figure 7.4: Use of `polarFreq} function to plot weighted mean SO<sub>2</sub> concentrations (ppb) by wind speed/directions and year
</p>
</div>
<p>Users are encouraged to try out other plot options. However, one
potentially useful plot is to select a few specific years of user
interest. For example, what if you just wanted to compare two years
e.g. 2000 and 2003? This is easy to do by sending a subset of data to
the function. Use here can be made of the <span class="pkg">openair</span> <code>selectByDate</code>
function (see Section <a href="sec-utility.html#sec:selectByDate">23.1</a>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sec-polarFreq.html#cb46-1" aria-hidden="true"></a><span class="co"># wind rose for just 2000 and 2003</span></span>
<span id="cb46-2"><a href="sec-polarFreq.html#cb46-2" aria-hidden="true"></a><span class="kw">polarFreq</span>(<span class="kw">selectByDate</span>(mydata, <span class="dt">year =</span> <span class="kw">c</span>(<span class="dv">2000</span>, <span class="dv">2003</span>)),</span>
<span id="cb46-3"><a href="sec-polarFreq.html#cb46-3" aria-hidden="true"></a>          <span class="dt">cols =</span> <span class="st">&quot;jet&quot;</span>,</span>
<span id="cb46-4"><a href="sec-polarFreq.html#cb46-4" aria-hidden="true"></a>          <span class="dt">type =</span> <span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<p>The <code>polarFreq</code> function can also be used to gain an idea about the
wind directions that contribute most to the overall mean
concentrations. As already shown, use of the option <code>statistic =   "weighted.mean"</code> will show the percentage contribution by wind
direction and wind speed bin. However, often it is unnecessary to
consider different wind speed intervals. To make the plot more
effective, a few options are set as shown in Figure
<a href="sec-polarFreq.html#fig:polarFreqAttr">7.5</a>. First, the <code>statistic =   "weighted.mean"</code> is chosen to ensure that the plot shows
concentrations weighted by their frequency of occurrence of wind
direction. For this plot, we are mostly interested in just the
contribution by wind direction and not wind speed. Setting the
<code>ws.int</code> to be above the maximum wind speed in the data set ensures
that all data are shown in one interval. Rather than having a
square-root transform applied to the colour scale, we choose to have a
linear scale by setting <code>trans = FALSE</code>. Finally, to show a ‘disk’,
the <code>offset</code> is set at 80. Increasing the value of the offset will
narrow the disk.</p>
<p>While Figure <a href="sec-polarFreq.html#fig:polarFreqAttr">7.5</a> is useful — e.g. it clearly shows
that concentrations of NO<sub>x</sub> at this site are totally dominated by
south-westerly winds, the use of <code>pollutionRose</code> for this type of
plot is more effective, as shown in Section <a href="sec-windRose.html#sec:windRose">6</a>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sec-polarFreq.html#cb47-1" aria-hidden="true"></a><span class="kw">polarFreq</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">ws.int =</span> <span class="dv">30</span>, </span>
<span id="cb47-2"><a href="sec-polarFreq.html#cb47-2" aria-hidden="true"></a>          <span class="dt">statistic =</span> <span class="st">&quot;weighted.mean&quot;</span>,</span>
<span id="cb47-3"><a href="sec-polarFreq.html#cb47-3" aria-hidden="true"></a>          <span class="dt">offset =</span> <span class="dv">80</span>, <span class="dt">trans =</span> <span class="ot">FALSE</span>, </span>
<span id="cb47-4"><a href="sec-polarFreq.html#cb47-4" aria-hidden="true"></a>          <span class="dt">col =</span> <span class="st">&quot;heat&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:polarFreqAttr"></span>
<img src="openair_files/figure-html/polarFreqAttr-1.png" alt="The percentage contribution to overall mean concentrations of NO~x~ at Marylebone Road." width="50%" />
<p class="caption">
Figure 7.5: The percentage contribution to overall mean concentrations of NO<sub>x</sub> at Marylebone Road.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-windRose.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-percentileRose.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/polar-freq.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["openair.pdf", "openair.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
