<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section15 Theil-Sen trends | openair</title>
  <meta name="description" content="This will eventually form a book related to the openair R package." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section15 Theil-Sen trends | openair" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This will eventually form a book related to the openair R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section15 Theil-Sen trends | openair" />
  
  <meta name="twitter:description" content="This will eventually form a book related to the openair R package." />
  

<meta name="author" content="David Carslaw" />


<meta name="date" content="2020-07-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-calendarPlot.html"/>
<link rel="next" href="sec-smoothTrend.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>3</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>3.1</b> Accessing data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>3.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="3.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>3.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>4</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>4.1</b> The <code>worldmet</code> package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>5</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>5.1</b> Example of use</a></li>
<li class="chapter" data-level="5.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>5.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>6</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>6.2</b> Examples</a></li>
<li class="chapter" data-level="6.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>6.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>7</b> Polar plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>7.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="7.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>7.2</b> Examples</a></li>
<li class="chapter" data-level="7.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>7.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="7.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>7.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="7.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>7.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="7.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>7.6</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>8</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>8.1</b> Purpose</a></li>
<li class="chapter" data-level="8.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>8.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>9</b> Time series plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>9.1</b> Background</a></li>
<li class="chapter" data-level="9.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>9.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>10</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>10.1</b> Purpose</a></li>
<li class="chapter" data-level="10.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>10.2</b> Applications</a></li>
<li class="chapter" data-level="10.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>10.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>11</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>11.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>12</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>12.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="12.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>12.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html"><i class="fa fa-check"></i><b>13</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterPurpose"><i class="fa fa-check"></i><b>13.1</b> Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterEx"><i class="fa fa-check"></i><b>13.2</b> Examples</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:hexbin"><i class="fa fa-check"></i><b>13.2.1</b> Hexaganol binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>14</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>14.1</b> Purpose</a></li>
<li class="chapter" data-level="14.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>14.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>15</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>15.1</b> Trend estimates</a></li>
<li class="chapter" data-level="15.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>15.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>15.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>16</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>16.1</b> Background</a></li>
<li class="chapter" data-level="16.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>16.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="16.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>16.3</b> Seasonal averages</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html"><i class="fa fa-check"></i><b>17</b> Trajectory analysis</a>
<ul>
<li class="chapter" data-level="17.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#plotting-trajectories"><i class="fa fa-check"></i><b>17.1</b> Plotting trajectories</a></li>
<li class="chapter" data-level="17.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajLevel"><i class="fa fa-check"></i><b>17.2</b> Trajectory gridded frequencies</a></li>
<li class="chapter" data-level="17.3" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#trajectory-source-contribution-functions"><i class="fa fa-check"></i><b>17.3</b> Trajectory source contribution functions</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#identifying-the-contribution-of-high-concentration-back-trajectories"><i class="fa fa-check"></i><b>17.3.1</b> Identifying the contribution of high concentration back trajectories</a></li>
<li class="chapter" data-level="17.3.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#allocating-trajectories-to-different-wind-sectors"><i class="fa fa-check"></i><b>17.3.2</b> Allocating trajectories to different wind sectors</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#potential-source-contribution-function-pscf"><i class="fa fa-check"></i><b>17.4</b> Potential Source Contribution Function (PSCF)</a></li>
<li class="chapter" data-level="17.5" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#concentration-weighted-trajectory-cwt"><i class="fa fa-check"></i><b>17.5</b> Concentration Weighted Trajectory (CWT)</a></li>
<li class="chapter" data-level="17.6" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajCluster"><i class="fa fa-check"></i><b>17.6</b> Trajectory clustering</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sec-utility.html"><a href="sec-utility.html"><i class="fa fa-check"></i><b>18</b> Utility functions</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectByDate"><i class="fa fa-check"></i><b>18.1</b> Selecting data by date</a></li>
<li class="chapter" data-level="18.2" data-path="sec-utility.html"><a href="sec-utility.html#sec:cutData"><i class="fa fa-check"></i><b>18.2</b> Making intervals — <code>cutData</code></a></li>
<li class="chapter" data-level="18.3" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectRunning"><i class="fa fa-check"></i><b>18.3</b> Selecting run lengths of values above a threshold — pollution episodes</a></li>
<li class="chapter" data-level="18.4" data-path="sec-utility.html"><a href="sec-utility.html#sec:rollingMean"><i class="fa fa-check"></i><b>18.4</b> Calculating rolling means</a></li>
<li class="chapter" data-level="18.5" data-path="sec-utility.html"><a href="sec-utility.html#sec:timeAverage"><i class="fa fa-check"></i><b>18.5</b> Aggregating data by different time intervals</a></li>
<li class="chapter" data-level="18.6" data-path="sec-utility.html"><a href="sec-utility.html#sec:calcPercentile"><i class="fa fa-check"></i><b>18.6</b> Calculating percentiles</a></li>
<li class="chapter" data-level="18.7" data-path="sec-utility.html"><a href="sec-utility.html#sec:corPlot"><i class="fa fa-check"></i><b>18.7</b> Correlation matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">openair</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:TheilSen" class="section level1" number="15">
<h1><span class="header-section-number">Section15</span> Theil-Sen trends</h1>
<div id="trend-estimates" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Trend estimates</h2>
<p>Calculating trends for air pollutants is one of the most important and
common tasks that can be undertaken. Trends are calculated for all
sorts of reasons. Sometimes it is useful to have a general idea about
how concentrations might have changed. On other occasions a more
definitive analysis is required; for example, to establish
statistically whether a trend is significant or not. The whole area of
trend calculation is a complex one and frequently trends are
calculated with little consideration as to their validity. Perhaps the
most common approach is to apply linear regression and not think twice
about it. However, there can be many pitfalls when using ordinary
linear regression, such as the assumption of normality,
autocorrelation etc.</p>
<p>One commonly used approach for trend calculation in studies of air
pollution is the non-parametric <em>Mann-Kendall</em> approach
<span class="citation">(Hirsch, Slack, and Smith <a href="#ref-Hirsch1982" role="doc-biblioref">1982</a>)</span>. <span class="citation">Wilcox (<a href="#ref-Wilcox2010" role="doc-biblioref">2010</a>)</span> provides an excellent case for
using ‘modern methods’ for regression including the benefits of
non-parametric approaches and bootstrap simulations. Note also that
the all the regression parameters are estimated through bootstrap
resampling.</p>
<p>The Theil-Sen method dates back to 1950, but the basic idea pre-dates
1950 <span class="citation">(Theil <a href="#ref-theil50" role="doc-biblioref">1950</a>; Sen <a href="#ref-sen1968" role="doc-biblioref">1968</a>)</span>. It is one of those methods that
required the invention of fast computers to be practical. The basic
idea is as follows. Given a set of <span class="math inline">\(n\)</span> <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> pairs, the slopes
between all pairs of points are calculated. Note, the number of slopes
can increase by <span class="math inline">\(\approx\)</span> <span class="math inline">\(n^2\)</span> so that the number of slopes can
increase rapidly as the length of the data set increases. The
Theil-Sen estimate of the slope is the median of all these slopes. The
advantage of the using the Theil-Sen estimator is that it tends to
yield accurate confidence intervals even with non-normal data and
heteroscedasticity (non-constant error variance). It is also
resistant to outliers — both characteristics can be important in air
pollution. As previously mentioned, the estimates of these parameters
can be made more robust through bootstrap-resampling, which further
adds to the computational burden, but is not an issue for most time
series which are expressed either as monthly or annual
means. Bootstrap resampling also provides the estimate of <span class="math inline">\(p\)</span> for the
slope.</p>
<p>An issue that can be very important for time series is dependence or
<em>autocorrelation</em> in the data. Normal (in the statistical sense)
statistics assume that data are independent, but in time series this
is rarely the case. The issue is that neighbouring data points are
similar to one another (correlated) and therefore not
independent. Ignoring this dependence would tend to give an overly
optimistic impression of uncertainties. However, taking account of it
is far from simple. A discussion of these issues is beyond the aims of
this report and readers are referred to standard statistical texts on
the issue. In <span class="pkg">openair</span> we follow the suggestion of <span class="citation">Kunsch (<a href="#ref-Kunsch1989" role="doc-biblioref">1989</a>)</span>
of setting the block length to <span class="math inline">\(n^{1/3}\)</span> where n is the length of the
time series.</p>
<p>There is a temptation when considering trends to use all the available
data. Why? Often it is useful to consider specific periods. For
example, is there any evidence that concentrations of have
decreased since 2000? Clearly, the time period used depends on both
the data and the questions, but it is good to be aware that
considering subsets of data can be very insightful.</p>
<p>Another aspect is that almost all trends are shown as mean
concentration versus time; typically by year. Such analyses are very
useful for understanding how concentrations have changed through time
and for comparison with air quality limits and regulations. However,
if one is interested in <em>understanding</em> why trends are as they
are, it can be helpful to consider how concentrations vary in other
ways. The trend functions in <span class="pkg">openair</span> do just this. Trends can be
plotted by day of the week, month, hour of the day, by wind direction
sector and by different wind speed ranges. All these capabilities are
easy to use and their effectiveness will depend on the situation in
question. One of the reasons that trends are not considered in these
many different ways is that there can be a considerable overhead in
carrying out the analysis, which is avoided by using these
functions. Few, for example, would consider a detailed trend analysis
by hour of the day, ensuring that robust statistical methods were used
and uncertainties calculated. However, it can be useful to consider
how concentrations vary in this way. It may be, for example, that the
hours around midday are dominated by heavy vehicle emissions rather
than by cars — so is the trend for a pollutant different for those
hours compared with say, hours dominated by other vehicle
types? Similarly, a much more focussed trend analysis can be done by
considering different wind direction, as this can help isolate
different source influences.</p>
<p>The <code>TheilSen</code> function is typically used to determine trends in
pollutant concentrations over several years. However, it can be used
to calculate the trend in any numeric variable. It calculates monthly
mean values from daily, hourly or higher time resolution data, as well
as working directly with monthly means. Whether it is meaningful to
calculate trends over shorter periods of time (e.g. 2 years) depends
very much on the data. It may well be that statistically significant
trends can be detected over relatively short periods but it is another
matter whether it matters. Because seasonal effects can be important
for monthly data, there is the option to deseasonalise the data
first. The <code>timeVariation</code> function are both useful to determine
whether there is a seasonal cycle that should be removed.</p>
<p>Note also that the symbols shown next to each trend estimate relate to
how statistically significant the trend estimate is: <span class="math inline">\(p\)</span> <span class="math inline">\(&lt;\)</span> 0.001 =
<span class="math inline">\(\ast\ast\ast\)</span>, <span class="math inline">\(p\)</span> <span class="math inline">\(&lt;\)</span> 0.01 = <span class="math inline">\(\ast\ast\)</span>, <span class="math inline">\(p\)</span> <span class="math inline">\(&lt;\)</span> 0.05 = <span class="math inline">\(\ast\)</span> and <span class="math inline">\(p\)</span> <span class="math inline">\(&lt;\)</span>
0.1 = <span class="math inline">\(+\)</span>.</p>
</div>
<div id="example-trend-analysis" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Example trend analysis</h2>
<p>We first show the use of the <code>TheilSen</code> function by applying it to
concentrations of O<sub>3</sub>. The function is called as shown in Figure
<a href="sec-TheilSen.html#fig:TheilSen1">15.1</a>.</p>

<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sec-TheilSen.html#cb123-1" aria-hidden="true"></a><span class="kw">library</span>(openair)</span>
<span id="cb123-2"><a href="sec-TheilSen.html#cb123-2" aria-hidden="true"></a><span class="kw">TheilSen</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, </span>
<span id="cb123-3"><a href="sec-TheilSen.html#cb123-3" aria-hidden="true"></a>         <span class="dt">ylab =</span> <span class="st">&quot;ozone (ppb)&quot;</span>, </span>
<span id="cb123-4"><a href="sec-TheilSen.html#cb123-4" aria-hidden="true"></a>         <span class="dt">deseason =</span> <span class="ot">TRUE</span>,</span>
<span id="cb123-5"><a href="sec-TheilSen.html#cb123-5" aria-hidden="true"></a>         <span class="dt">date.format =</span> <span class="st">&quot;%Y&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Taking bootstrap samples. Please wait.&quot;</code></pre>
<div class="figure"><span id="fig:TheilSen1"></span>
<img src="openair_files/figure-html/TheilSen1-1.png" alt="Trends in ozone at Marylebone Road. The plot shows the deseasonalised monthly mean concentrations of O3. The solid red line shows the trend estimate and the dashed red lines show the 95% confidence intervals for the trend based on resampling methods. The overall trend is shown at the top-left as 0.38 (ppb) per year and the 95% confidence intervals in the slope from 0.21–0.51 ppb/year. The \(\ast\ast\ast\) show that the trend is significant to the 0.001 level." width="70%" />
<p class="caption">
Figure 15.1: Trends in ozone at Marylebone Road. The plot shows the deseasonalised monthly mean concentrations of O<sub>3</sub>. The solid red line shows the trend estimate and the dashed red lines show the 95% confidence intervals for the trend based on resampling methods. The overall trend is shown at the top-left as 0.38 (ppb) per year and the 95% confidence intervals in the slope from 0.21–0.51 ppb/year. The <span class="math inline">\(\ast\ast\ast\)</span> show that the trend is significant to the 0.001 level.
</p>
</div>
<p>Because the function runs simulations to estimate the uncertainty in
the slope, it can take a little time for all the calculations to
finish. These printed results show that in this case the trend in
O<sub>3</sub> was +0.38 units (i.e. ppb) per year as an average over the
entire period. It also shows the 95% confidence intervals in the
trend ranged between 0.21 to 0.51 ppb/year. Finally, the significance
level in this case is very high; providing very strong evidence that
concentrations of O<sub>3</sub> increased over the period. The plot together
with the summary results is shown in Figure <a href="sec-TheilSen.html#fig:TheilSen1">15.1</a>. Note
that if one wanted to display the confidence intervals in the slope at
the 99% confidence intervals, the code would be Figure
<a href="sec-TheilSen.html#fig:TheilSen2">15.2</a>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sec-TheilSen.html#cb125-1" aria-hidden="true"></a><span class="kw">TheilSen</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;ozone (ppb)&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p>Sometimes it is useful to consider a subset of data, perhaps by
excluding some years. This is easy with the <code>filter</code> function. The
following code calculates trends for years greater than 1999 i.e. from
2000 onward.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sec-TheilSen.html#cb126-1" aria-hidden="true"></a><span class="kw">TheilSen</span>(<span class="kw">filter</span>(mydata, <span class="kw">format</span>(date, <span class="st">&quot;%Y&quot;</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1999</span>), </span>
<span id="cb126-2"><a href="sec-TheilSen.html#cb126-2" aria-hidden="true"></a>         <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>,</span>
<span id="cb126-3"><a href="sec-TheilSen.html#cb126-3" aria-hidden="true"></a>         <span class="dt">ylab =</span> <span class="st">&quot;ozone (ppb)&quot;</span>)</span></code></pre></div>
<p>It is also possible to calculate trends in many other ways e.g. by
wind direction. Considering how trends vary by wind direction can be
extremely useful because the influence of different sources invariably
depends on the direction of the wind. The <code>TheilSen</code> function
splits the wind direction into 8 sectors i.e. N, NE, E etc. The
Theil-Sen slopes are then calculated for each direction in turn. This
function takes rather longer to run because the simulations need to be
run eight times in total. Considering concentrations of O<sub>3</sub> again,
the output is shown in Figure <a href="sec-TheilSen.html#fig:TheilSen2">15.2</a>. Note that this plot is
specifically laid out to assist interpretation, with each panel
located at the correct point on the compass. This makes it easy to see
immediately that there is essentially no trend in O<sub>3</sub> for southerly
winds i.e. where the road itself has the strongest influence. On the
other hand the strongest evidence of increasing O<sub>3</sub> are for
northerly winds, where the influence of the road is much less. The
reason that there is no trend in O<sub>3</sub> for southerly winds is that
there is always a great excess of NO, which reacts with O<sub>3</sub> to form
NO<sub>2</sub>. At this particular location it will probably take many more
years before O<sub>3</sub> concentrations start to increase when the wind
direction is southerly. Nevertheless, there will always be <em>some</em>
hours that do not have such high concentrations of NO.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sec-TheilSen.html#cb127-1" aria-hidden="true"></a><span class="kw">TheilSen</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;wd&quot;</span>, </span>
<span id="cb127-2"><a href="sec-TheilSen.html#cb127-2" aria-hidden="true"></a>         <span class="dt">deseason =</span> <span class="ot">TRUE</span>,</span>
<span id="cb127-3"><a href="sec-TheilSen.html#cb127-3" aria-hidden="true"></a>         <span class="dt">date.format =</span> <span class="st">&quot;%Y&quot;</span>,</span>
<span id="cb127-4"><a href="sec-TheilSen.html#cb127-4" aria-hidden="true"></a>         <span class="dt">ylab =</span> <span class="st">&quot;ozone (ppb)&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;</code></pre>
<div class="figure"><span id="fig:TheilSen2"></span>
<img src="openair_files/figure-html/TheilSen2-1.png" alt="Trends in ozone at Marylebone Road split by eight wind sectors. The `TheilSen` function will automatically organise the separate panels by the different compass directions." width="960" />
<p class="caption">
Figure 15.2: Trends in ozone at Marylebone Road split by eight wind sectors. The <code>TheilSen</code> function will automatically organise the separate panels by the different compass directions.
</p>
</div>
<p>The option <code>slope.percent</code> can be set to express slope
estimates as a percentage change per year. This is useful for
comparing slopes for sites with very different concentration levels
and for comparison with emission inventories. The percentage change
uses the concentration at the beginning and end months to express the
mean slope.</p>
<p>The trend, <span class="math inline">\(T\)</span> is defined as:</p>
<p><span class="math display" id="eq:MannK">\[
T [\%.yr^{-1}] = 100.\left(\frac{C_{End}}{C_{Start}}
  - 1\right)\Bigg /N_{years} \tag{15.1}
\]</span></p>
<p>where <span class="math inline">\(C_{End}\)</span> and <span class="math inline">\(C_{Start}\)</span> are the mean concentrations for the
end and start date, respectfully. <span class="math inline">\(N_{years}\)</span> is the
number of years (or fractions of) the time series spans.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sec-TheilSen.html#cb129-1" aria-hidden="true"></a><span class="kw">TheilSen</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">deseason =</span> <span class="ot">TRUE</span>,</span>
<span id="cb129-2"><a href="sec-TheilSen.html#cb129-2" aria-hidden="true"></a>            <span class="dt">slope.percent =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The <code>TheilSen</code> function was written to work with hourly data,
which is then averaged into monthly or annual data. However, it is
realised that users may already have data that is monthly or
annual. The function can therefore accept as input monthly or annual
data directly. <em>However, it is necessary to ensure the date field
is in the correct format</em>. Assuming data in an Excel file in the
format dd/mm/YYYY (e.g. 23/11/2008), it is necessary to convert this
to a date format understood by R, as shown below. Similarly, if annual
data were available, get the dates in formats like ‘2005-01-01’,
‘2006-01-01’ … and make sure the date is again formatted using
<code>as.Date</code>. Note that if dates are pre-formatted as YYYY-mm-dd,
then it is sufficient to use <code>as.Date</code> without providing any
format information because it is already in the correct format.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="sec-TheilSen.html#cb130-1" aria-hidden="true"></a>mydata<span class="op">$</span>date =<span class="st"> </span><span class="kw">as.Date</span>(mydata<span class="op">$</span>date, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%Y&quot;</span>)</span></code></pre></div>
<p>Finally, the <code>TheilSen</code> function can consider trends at
different sites, provided the input data are correctly formatted. For
input, a data frame with three columns is required: date, pollutant
and <em>site</em>. The call would then be, for example:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sec-TheilSen.html#cb131-1" aria-hidden="true"></a><span class="kw">TheilSen</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;site&quot;</span>)</span></code></pre></div>
<div id="output" class="section level3" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Output</h3>
<p>The <code>TheilSen</code> function provides lots of output data for further
analysis or adding to a report. To obtain it, it is necessary to read
it into a variable:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="sec-TheilSen.html#cb132-1" aria-hidden="true"></a>MKresults &lt;-<span class="st">  </span><span class="kw">TheilSen</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">deseason =</span> <span class="ot">TRUE</span>, <span class="dt">type =</span> <span class="st">&quot;wd&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;
## [1] &quot;Taking bootstrap samples. Please wait.&quot;</code></pre>
<p>This returns a list of two data frames containing all the monthly mean values and
trend statistics and an aggregated summary. The first 6 lines are shown next:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="sec-TheilSen.html#cb134-1" aria-hidden="true"></a><span class="kw">head</span>(MKresults<span class="op">$</span>data[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>##   wd       date      conc         a            b   upper.a     upper.b  lower.a
## 1  E 1998-01-01  5.552253 -2.825001 0.0007185124 -8.826666 0.001230109 3.848278
## 2  E 1998-02-01  2.919639 -2.825001 0.0007185124 -8.826666 0.001230109 3.848278
## 3  E 1998-03-01  3.849363 -2.825001 0.0007185124 -8.826666 0.001230109 3.848278
## 4  E 1998-04-01  4.051668 -2.825001 0.0007185124 -8.826666 0.001230109 3.848278
## 5  E 1998-05-01  2.304686 -2.825001 0.0007185124 -8.826666 0.001230109 3.848278
## 6  E 1998-06-01 -1.560438 -2.825001 0.0007185124 -8.826666 0.001230109 3.848278
##        lower.b          p p.stars    slope intercept intercept.lower
## 1 0.0001449688 0.01669449       * 0.262257 -2.825001        3.848278
## 2 0.0001449688 0.01669449       * 0.262257 -2.825001        3.848278
## 3 0.0001449688 0.01669449       * 0.262257 -2.825001        3.848278
## 4 0.0001449688 0.01669449       * 0.262257 -2.825001        3.848278
## 5 0.0001449688 0.01669449       * 0.262257 -2.825001        3.848278
## 6 0.0001449688 0.01669449       * 0.262257 -2.825001        3.848278
##   intercept.upper      lower     upper slope.percent lower.percent
## 1       -8.826666 0.05291362 0.4489896       5.79801     0.9925881
## 2       -8.826666 0.05291362 0.4489896       5.79801     0.9925881
## 3       -8.826666 0.05291362 0.4489896       5.79801     0.9925881
## 4       -8.826666 0.05291362 0.4489896       5.79801     0.9925881
## 5       -8.826666 0.05291362 0.4489896       5.79801     0.9925881
## 6       -8.826666 0.05291362 0.4489896       5.79801     0.9925881
##   upper.percent
## 1       11.9614
## 2       11.9614
## 3       11.9614
## 4       11.9614
## 5       11.9614
## 6       11.9614</code></pre>
<p>Often only the trend statistics are required and not all the monthly
values. These can be obtained by:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="sec-TheilSen.html#cb136-1" aria-hidden="true"></a>MKresults<span class="op">$</span>data[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>##   wd p.stars       date     conc          a            b     upper.a
## 1  E       * 2001-09-15 5.989974  -2.825001 7.185124e-04  -8.8266663
## 2  N     *** 2001-09-15 9.786267 -19.142102 2.485907e-03 -28.7157702
## 3 NE     *** 2001-09-15 9.728994  -9.728741 1.624970e-03 -24.8702270
## 4 NW     *** 2001-09-15 9.786755 -12.940875 1.937119e-03 -22.4192235
## 5  S         2001-09-15 5.052728   4.472516 2.509968e-05   1.0744367
## 6 SE         2001-09-15 5.780645   4.822713 7.357549e-05   0.8230425
## 7 SW         2001-09-15 4.761100   1.818359 2.444766e-04  -1.9192744
## 8  W      ** 2001-09-15 5.618727  -1.178793 5.736058e-04  -5.6090971
##        upper.b   lower.a       lower.b           p       slope  intercept
## 1 0.0012301086  3.848278  1.449688e-04 0.016694491 0.262257022  -2.825001
## 2 0.0032893251 -9.725509  1.649012e-03 0.000000000 0.907355964 -19.142102
## 3 0.0029640572  3.185458  5.003924e-04 0.000000000 0.593114074  -9.728741
## 4 0.0027690442 -3.396506  1.122414e-03 0.000000000 0.707048447 -12.940875
## 5 0.0003281521  7.156572 -2.081018e-04 0.868113523 0.009161382   4.472516
## 6 0.0004318379  8.727162 -2.572925e-04 0.684474124 0.026855053   4.822713
## 7 0.0005716588  5.538235 -8.999974e-05 0.110183639 0.089233973   1.818359
## 8 0.0009552189  3.041723  2.044787e-04 0.003338898 0.209366110  -1.178793
##   intercept.lower intercept.upper       lower     upper slope.percent
## 1        3.848278      -8.8266663  0.05291362 0.4489896     5.7980099
## 2       -9.725509     -28.7157702  0.60188926 1.2006037    14.4454302
## 3        3.185458     -24.8702270  0.18264323 1.0818809     8.6085473
## 4       -3.396506     -22.4192235  0.40968128 1.0107011    10.2917646
## 5        7.156572       1.0744367 -0.07595715 0.1197755     0.1937191
## 6        8.727162       0.8230425 -0.09391177 0.1576208     0.4816904
## 7        5.538235      -1.9192744 -0.03284991 0.2086555     2.0662607
## 8        3.041723      -5.6090971  0.07463472 0.3486549     4.4665024
##   lower.percent upper.percent
## 1     0.9925881     11.961401
## 2     8.4310805     24.381910
## 3     2.1997335     19.875875
## 4     5.0687904     17.131133
## 5    -1.5105886      2.703463
## 6    -1.5405900      3.008348
## 7    -0.7113745      5.313247
## 8     1.4540385      8.381275</code></pre>
<p>In the results above the <code>lower</code> and <code>upper</code> fields provide the
95% (or chosen confidence interval using the <code>alpha</code> option) of
the trend and <code>slope</code> is the trend estimate expressed in units/year.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Hirsch1982">
<p>Hirsch, R. M., J. R. Slack, and R. A. Smith. 1982. “Techniques of Trend Analysis for Monthly Water-Quality Data.” <em>Water Resources Research</em> 18 (1): 107–21.</p>
</div>
<div id="ref-Kunsch1989">
<p>Kunsch, H. R. 1989. “The Jackknife and the Bootstrap for General Stationary Observations.” <em>Annals of Statistics</em> 17 (3): 1217–41.</p>
</div>
<div id="ref-sen1968">
<p>Sen, P. K. 1968. “Estimates of Regression Coefficient Based on Kendall’s Tau.” <em>Journal of the American Statistical Association</em> 63(324): 1379–89.</p>
</div>
<div id="ref-theil50">
<p>Theil, H. 1950. “A Rank Invariant Method of Linear and Polynomial Regression Analysis, I, Ii, Iii.” <em>Proceedings of the Koninklijke Nederlandse Akademie Wetenschappen, Series A – Mathematical Sciences</em> 53: 386–92, 521–25, 1397–1412.</p>
</div>
<div id="ref-Wilcox2010">
<p>Wilcox, Rand R. 2010. <em>Fundamentals of Modern Statistical Methods: Substantially Improving Power and Accuracy</em>. 2nd ed. Springer New York. <a href="http://www.springerlink.com/content/978-1-4419-5524-1">http://www.springerlink.com/content/978-1-4419-5524-1</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-calendarPlot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-smoothTrend.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/theil-sen.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["openair.pdf", "openair.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
