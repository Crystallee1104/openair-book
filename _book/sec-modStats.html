<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section20 Model evaluation | openair</title>
  <meta name="description" content="This will eventually form a book related to the openair R package." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section20 Model evaluation | openair" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This will eventually form a book related to the openair R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section20 Model evaluation | openair" />
  
  <meta name="twitter:description" content="This will eventually form a book related to the openair R package." />
  

<meta name="author" content="David Carslaw" />


<meta name="date" content="2020-07-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-conditionalQuantile.html"/>
<link rel="next" href="sec-TaylorDiagram.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#hello-and-welcome"><i class="fa fa-check"></i>Hello and welcome</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-openair-package.html"><a href="sec-openair-package.html"><i class="fa fa-check"></i><b>2</b> The openair package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-openair-package.html"><a href="sec-openair-package.html#access-to-source-code"><i class="fa fa-check"></i><b>2.1</b> Access to source code</a></li>
<li class="chapter" data-level="2.2" data-path="sec-openair-package.html"><a href="sec-openair-package.html#input-data-requirements"><i class="fa fa-check"></i><b>2.2</b> Input data requirements</a></li>
<li class="chapter" data-level="2.3" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:brief-intr-open"><i class="fa fa-check"></i><b>2.3</b> Brief overview of openair</a></li>
<li class="chapter" data-level="2.4" data-path="sec-openair-package.html"><a href="sec-openair-package.html#the-type-option"><i class="fa fa-check"></i><b>2.4</b> The type option</a></li>
<li class="chapter" data-level="2.5" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:font-size"><i class="fa fa-check"></i><b>2.5</b> Controlling font size</a></li>
<li class="chapter" data-level="2.6" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:colours"><i class="fa fa-check"></i><b>2.6</b> Using colours</a></li>
<li class="chapter" data-level="2.7" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:quickText"><i class="fa fa-check"></i><b>2.7</b> Automatic text formatting</a></li>
<li class="chapter" data-level="2.8" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:multiple-plots-page"><i class="fa fa-check"></i><b>2.8</b> Multiple plots on a page</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>3</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>3.1</b> Accessing data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>3.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="3.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>3.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>4</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>4.1</b> The worldmet package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>5</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>5.1</b> Example of use</a></li>
<li class="chapter" data-level="5.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>5.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html"><i class="fa fa-check"></i><b>6</b> Polar frequencies</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html#sec:polarFreqBack"><i class="fa fa-check"></i><b>6.1</b> Background and examples</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>7</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>7.2</b> Examples</a></li>
<li class="chapter" data-level="7.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>7.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>8</b> Polar plots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>8.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="8.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>8.2</b> Examples</a></li>
<li class="chapter" data-level="8.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>8.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="8.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>8.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="8.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>8.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="8.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>8.6</b> Clustering</a></li>
<li class="chapter" data-level="8.7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plots-on-an-interactive-map"><i class="fa fa-check"></i><b>8.7</b> Polar plots on an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>9</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>9.1</b> Purpose</a></li>
<li class="chapter" data-level="9.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>9.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>10</b> Time series plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>10.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>11</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>11.1</b> Purpose</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>11.2</b> Applications</a></li>
<li class="chapter" data-level="11.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>11.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>12</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>12.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>13</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>13.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="13.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>13.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html"><i class="fa fa-check"></i><b>14</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterPurpose"><i class="fa fa-check"></i><b>14.1</b> Purpose</a></li>
<li class="chapter" data-level="14.2" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterEx"><i class="fa fa-check"></i><b>14.2</b> Examples</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:hexbin"><i class="fa fa-check"></i><b>14.2.1</b> Hexaganol binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>15</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>15.1</b> Purpose</a></li>
<li class="chapter" data-level="15.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>15.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>16</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>16.1</b> Trend estimates</a></li>
<li class="chapter" data-level="16.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>16.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>16.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>17</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="17.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>17.1</b> Background</a></li>
<li class="chapter" data-level="17.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>17.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="17.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>17.3</b> Seasonal averages</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html"><i class="fa fa-check"></i><b>18</b> Trajectory analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#plotting-trajectories"><i class="fa fa-check"></i><b>18.1</b> Plotting trajectories</a></li>
<li class="chapter" data-level="18.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajLevel"><i class="fa fa-check"></i><b>18.2</b> Trajectory gridded frequencies</a></li>
<li class="chapter" data-level="18.3" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#trajectory-source-contribution-functions"><i class="fa fa-check"></i><b>18.3</b> Trajectory source contribution functions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#identifying-the-contribution-of-high-concentration-back-trajectories"><i class="fa fa-check"></i><b>18.3.1</b> Identifying the contribution of high concentration back trajectories</a></li>
<li class="chapter" data-level="18.3.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#allocating-trajectories-to-different-wind-sectors"><i class="fa fa-check"></i><b>18.3.2</b> Allocating trajectories to different wind sectors</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#potential-source-contribution-function-pscf"><i class="fa fa-check"></i><b>18.4</b> Potential Source Contribution Function (PSCF)</a></li>
<li class="chapter" data-level="18.5" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#concentration-weighted-trajectory-cwt"><i class="fa fa-check"></i><b>18.5</b> Concentration Weighted Trajectory (CWT)</a></li>
<li class="chapter" data-level="18.6" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajCluster"><i class="fa fa-check"></i><b>18.6</b> Trajectory clustering</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html"><i class="fa fa-check"></i><b>19</b> Conditional quantiles</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalQuantileBack"><i class="fa fa-check"></i><b>19.1</b> Background</a></li>
<li class="chapter" data-level="19.2" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalEval"><i class="fa fa-check"></i><b>19.2</b> Conditional evaluation</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sec-modStats.html"><a href="sec-modStats.html"><i class="fa fa-check"></i><b>20</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModBack"><i class="fa fa-check"></i><b>20.1</b> Background</a></li>
<li class="chapter" data-level="20.2" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModEx"><i class="fa fa-check"></i><b>20.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html"><i class="fa fa-check"></i><b>21</b> Taylor Diagam</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#sec:TaylorBack"><i class="fa fa-check"></i><b>21.1</b> Background</a></li>
<li class="chapter" data-level="21.2" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#examples-of-taylor-diagrams"><i class="fa fa-check"></i><b>21.2</b> Examples of Taylor Diagrams</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sec-utility.html"><a href="sec-utility.html"><i class="fa fa-check"></i><b>22</b> Utility functions</a>
<ul>
<li class="chapter" data-level="22.1" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectByDate"><i class="fa fa-check"></i><b>22.1</b> Selecting data by date</a></li>
<li class="chapter" data-level="22.2" data-path="sec-utility.html"><a href="sec-utility.html#sec:cutData"><i class="fa fa-check"></i><b>22.2</b> Making intervals — cutData</a></li>
<li class="chapter" data-level="22.3" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectRunning"><i class="fa fa-check"></i><b>22.3</b> Selecting run lengths of values above a threshold — pollution episodes</a></li>
<li class="chapter" data-level="22.4" data-path="sec-utility.html"><a href="sec-utility.html#sec:rollingMean"><i class="fa fa-check"></i><b>22.4</b> Calculating rolling means</a></li>
<li class="chapter" data-level="22.5" data-path="sec-utility.html"><a href="sec-utility.html#sec:timeAverage"><i class="fa fa-check"></i><b>22.5</b> Aggregating data by different time intervals</a></li>
<li class="chapter" data-level="22.6" data-path="sec-utility.html"><a href="sec-utility.html#sec:calcPercentile"><i class="fa fa-check"></i><b>22.6</b> Calculating percentiles</a></li>
<li class="chapter" data-level="22.7" data-path="sec-utility.html"><a href="sec-utility.html#sec:corPlot"><i class="fa fa-check"></i><b>22.7</b> Correlation matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html"><i class="fa fa-check"></i><b>A</b> Annotating openair plots</a>
<ul>
<li class="chapter" data-level="A.1" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text"><i class="fa fa-check"></i><b>A.1</b> Adding text</a></li>
<li class="chapter" data-level="A.2" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text-and-a-shaded-area"><i class="fa fa-check"></i><b>A.2</b> Adding text and a shaded area</a></li>
<li class="chapter" data-level="A.3" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-an-arrow"><i class="fa fa-check"></i><b>A.3</b> Adding an arrow</a></li>
<li class="chapter" data-level="A.4" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-a-reference-line-and-text"><i class="fa fa-check"></i><b>A.4</b> Adding a reference line and text</a></li>
<li class="chapter" data-level="A.5" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#highlight-a-specific-point"><i class="fa fa-check"></i><b>A.5</b> Highlight a specific point</a></li>
<li class="chapter" data-level="A.6" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-a-filled-polygon"><i class="fa fa-check"></i><b>A.6</b> Add a filled polygon</a></li>
<li class="chapter" data-level="A.7" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-air-quality-bands-as-polygons"><i class="fa fa-check"></i><b>A.7</b> Add air quality bands as polygons</a></li>
<li class="chapter" data-level="A.8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>A.8</b> Polar plot examples</a></li>
<li class="chapter" data-level="A.9" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#using-grid-graphics-identify-locations-interactively"><i class="fa fa-check"></i><b>A.9</b> Using grid graphics — identify locations interactively</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">openair</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:modStats" class="section level1" number="20">
<h1><span class="header-section-number">Section20</span> Model evaluation</h1>
<div id="sec:ModBack" class="section level2" number="20.1">
<h2><span class="header-section-number">20.1</span> Background</h2>
<p>The <code>modStats</code> function provides key model evaluation statistics
for comparing models against measurements and models against other models.</p>
<p>There are a very wide range of evaluation statistics that can be used
to assess model performance. There is, however, no single statistic
that encapsulates all aspects of interest. For this reason it is
useful to consider several performance statistics and also to
understand the sort of information or insight they might provide.</p>
<p>In the following definitions, <span class="math inline">\(O_i\)</span> represents the <span class="math inline">\(i\)</span>th observed
value and <span class="math inline">\(M_i\)</span> represents the <span class="math inline">\(i\)</span>th modelled value for a total of
<span class="math inline">\(n\)</span> observations.</p>
<p><strong>Fraction of predictions within a factor or two, <em>FAC2</em> </strong></p>
<p>The fraction of modelled values within a factor of two of the
observed values are the fraction of model predictions that satisfy:</p>
<p><span class="math display" id="eq:FAC2">\[\begin{equation}
   0.5 \leq \frac{M_i}{O_i} \leq 2.0 \tag{20.1}
\end{equation}\]</span></p>
<p><strong>Mean bias, <em>MB</em> </strong></p>
<p>The mean bias provides a good indication of the mean over or under
estimate of predictions. Mean bias in the same units as the quantities
being considered.</p>
<p><span class="math display" id="eq:MB">\[\begin{equation}
 MB = \frac{1}{n}\sum_{i=1}^{N} M_i - O_i  \tag{20.2}
\end{equation}\]</span></p>
<p><strong>Mean Gross Error, <em>MGE</em> </strong></p>
<p>The mean gross error provides a good indication of the mean error
regardless of whether it is an over or under estimate. Mean gross
error is in the same units as the quantities being considered.</p>
<p><span class="math display" id="eq:MGE">\[\begin{equation}
 MGE = \frac{1}{n}\sum_{i=1}^{N} |M_i - O_i|   \tag{20.3}
\end{equation}\]</span></p>
<p><strong>Normalised mean bias, <em>NMB</em> </strong></p>
<p>The normalised mean bias is useful for comparing pollutants that cover
different concentration scales and the mean bias is normalised by
dividing by the observed concentration.</p>
<p><span class="math display" id="eq:NMB">\[\begin{equation}
 NMB = \frac{\sum\limits_{i=1}^{n} M_i - O_i}{\sum\limits_{i=1}^{n} O_i} \tag{20.4}
\end{equation}\]</span></p>
<p><strong>Normalised mean gross error, <em>NMGE</em> </strong></p>
<p>The normalised mean gross error further ignores whether a prediction
is an over or under estimate.</p>
<p><span class="math display" id="eq:NMGE">\[\begin{equation}
 NMGE = \frac{\sum\limits_{i=1}^{n} |M_i - O_i|}{\sum\limits_{i=1}^{n} O_i}  \tag{20.5}
\end{equation}\]</span></p>
<p><strong>Root mean squared error, <em>RMSE</em> </strong></p>
<p>The RMSE is a commonly used statistic that provides a good overall
measure of how close modelled values are to predicted values.</p>
<p><span class="math display" id="eq:RMSE">\[\begin{equation}
   RMSE = \left({\frac{\sum\limits_{i=1}^{n} (M_i - O_i)^2}{n}}\right)^{1/2}   \tag{20.6}
\end{equation}\]</span></p>
<p><strong>Correlation coefficient, <em>r</em> </strong></p>
<p>The (Pearson) correlation coefficient is a measure of the strength of
the linear relationship between two variables. If there is perfect
linear relationship with positive slope between the two variables, <span class="math inline">\(r\)</span>
= 1. If there is a perfect linear relationship with negative slope
between the two variables <span class="math inline">\(r\)</span> = -1. A correlation coefficient of 0
means that there is no linear relationship between the variables. Note
that <code>modStats</code> accepts an option <code>method</code>, which can be set to
“kendall” and “spearman” for alternative calculations of <span class="math inline">\(r\)</span>.</p>
<p><span class="math display" id="eq:r">\[\begin{equation}
 r = \frac{1}{(n-1)}\sum\limits_{i=1}^{n}\left(\frac{M_i - \overline{M}}{\sigma_M}\right)\left(\frac{O_i - \overline{O}}{\sigma_O}\right)   \tag{20.7}
\end{equation}\]</span></p>
<p><strong>Coefficient of Efficiency, <em>COE</em> </strong></p>
<p>The <em>Coefficient of Efficiency</em> based on
<span class="citation">Legates and McCabe (<a href="#ref-legates2012" role="doc-biblioref">2012</a>)</span> and <span class="citation">Legates and McCabe Jr (<a href="#ref-legates1999" role="doc-biblioref">1999</a>)</span>. There have been many suggestions for
measuring model performance over the years, but the <span class="math inline">\(COE\)</span> is a simple
formulation which is easy to interpret.</p>
<p>A perfect model has a <span class="math inline">\(COE\)</span> = 1. As noted by Legates and McCabe although
the <span class="math inline">\(COE\)</span> has no lower bound, a value of <span class="math inline">\(COE\)</span> = 0.0 has a fundamental
meaning. It implies that the model is no more able to predict the
observed values than does the observed mean. Therefore, since the
model can explain no more of the variation in the observed values than
can the observed mean, such a model can have no predictive advantage.</p>
<p>For negative values of <span class="math inline">\(COE\)</span>, the model is less effective than the
observed mean in predicting the variation in the observations.</p>
<p><span class="math display" id="eq:COE">\[\begin{equation}
 COE = 1.0 - \frac{\sum\limits_{i=1}^{n} |M_i
             -O_i|}{\sum\limits_{i=1}^{n} |O_i - \overline{O}|}   \tag{20.8}
\end{equation}\]</span></p>
<p><strong>Index of Agreement, <em>IOA</em> </strong></p>
<p>The <em>Index of Agreement</em>, <span class="math inline">\(IOA\)</span> is commonly used in model
evaluation <span class="citation">(Willmott, Robeson, and Matsuura <a href="#ref-Willmott2011" role="doc-biblioref">2011</a>)</span>. It spans between -1 and +1
with values approaching +1 representing better model performance. An
<span class="math inline">\(IOA\)</span> of 0.5, for example, indicates that the sum of the
error-magnitudes is one half of the sum of the observed-deviation
magnitudes. When <span class="math inline">\(IOA\)</span> = 0.0, it signifies that the sum of the
magnitudes of the errors and the sum of the observed-deviation
magnitudes are equivalent. When <span class="math inline">\(IOA\)</span> = -0.5, it indicates that the
sum of the error-magnitudes is twice the sum of the perfect
model-deviation and observed-deviation magnitudes. Values of <span class="math inline">\(IOA\)</span>
near -1.0 can mean that the model-estimated deviations about <span class="math inline">\(O\)</span> are
poor estimates of the observed deviations; but, they also can mean
that there simply is little observed variability — so some caution
is needed when the <span class="math inline">\(IOA\)</span> approaches -1. It is defined as (with <span class="math inline">\(c = 2\)</span>):</p>
<p><span class="math display" id="eq:IOA">\[\begin{equation}
IOA = \left\{
   \begin{array}{l}
     1.0 - \frac{\displaystyle \sum\limits_{i=1}^{n} |M_i-O_i|}
{\displaystyle c\sum\limits_{i=1}^{n} |O_i - \overline{O}|}, when \\
           \sum\limits_{i=1}^{n} |M_i-O_i| \le c\sum\limits_{i=1}^{n} |O_i - \overline{O}| \\
          \frac{\displaystyle c\sum\limits_{i=1}^{n} |O_i - \overline{O}|}
{\displaystyle \sum\limits_{i=1}^{n} |M_i-O_i|} - 1.0, when \\
           \sum\limits_{i=1}^{n} |M_i-O_i| &gt; c\sum\limits_{i=1}^{n} |O_i - \overline{O}|
   \end{array} \tag{20.9}
\right.
\end{equation}\]</span></p>
</div>
<div id="sec:ModEx" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> Example of use</h2>
<p>The function can be called very simply and only requires two numeric
fields to compare. To show how the function works, some synthetic data
will be generated for 5 models.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="sec-modStats.html#cb226-1" aria-hidden="true"></a><span class="co">## observations; 100 random numbers</span></span>
<span id="cb226-2"><a href="sec-modStats.html#cb226-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb226-3"><a href="sec-modStats.html#cb226-3" aria-hidden="true"></a>obs &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)</span>
<span id="cb226-4"><a href="sec-modStats.html#cb226-4" aria-hidden="true"></a>mod1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(obs, <span class="dt">mod =</span> obs <span class="op">+</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&quot;model 1&quot;</span>)</span>
<span id="cb226-5"><a href="sec-modStats.html#cb226-5" aria-hidden="true"></a>mod2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(obs, <span class="dt">mod =</span> obs <span class="op">+</span><span class="st"> </span><span class="dv">20</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dt">model =</span> <span class="st">&quot;model 2&quot;</span>)</span>
<span id="cb226-6"><a href="sec-modStats.html#cb226-6" aria-hidden="true"></a>mod3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(obs, <span class="dt">mod =</span> obs <span class="op">-</span><span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dt">model =</span> <span class="st">&quot;model 3&quot;</span>)</span>
<span id="cb226-7"><a href="sec-modStats.html#cb226-7" aria-hidden="true"></a>mod4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(obs, <span class="dt">mod =</span> obs <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dt">model =</span> <span class="st">&quot;model 4&quot;</span>)</span>
<span id="cb226-8"><a href="sec-modStats.html#cb226-8" aria-hidden="true"></a>mod5 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(obs, <span class="dt">mod =</span> obs <span class="op">*</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dt">model =</span> <span class="st">&quot;model 5&quot;</span>)</span>
<span id="cb226-9"><a href="sec-modStats.html#cb226-9" aria-hidden="true"></a>modData &lt;-<span class="st"> </span><span class="kw">rbind</span>(mod1, mod2, mod3, mod4, mod5)</span>
<span id="cb226-10"><a href="sec-modStats.html#cb226-10" aria-hidden="true"></a><span class="kw">head</span>(modData)</span></code></pre></div>
<pre><code>##         obs      mod   model
## 1 50.747820 60.74782 model 1
## 2 30.676851 40.67685 model 1
## 3 42.690767 52.69077 model 1
## 4 69.310208 79.31021 model 1
## 5  8.513597 18.51360 model 1
## 6 22.543662 32.54366 model 1</code></pre>
<p>We now have a data frame with observations and predictions for 5
models. The evaluation of the statistics is given by:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="sec-modStats.html#cb228-1" aria-hidden="true"></a><span class="kw">modStats</span>(modData, <span class="dt">obs =</span> <span class="st">&quot;obs&quot;</span>, <span class="dt">mod =</span> <span class="st">&quot;mod&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<pre><code>##     model   n FAC2         MB       MGE         NMB      NMGE      RMSE
## 1 model 1 100 0.89  10.000000 10.000000  0.22455508 0.2245551 10.000000
## 2 model 2 100 0.79   0.922391 16.592192  0.02071276 0.3725861 19.318041
## 3 model 3 100 0.88   1.013647  7.887325  0.02276196 0.1771139  9.451354
## 4 model 4 100 0.56 -20.603684 21.860655 -0.46266619 0.4908921 25.758520
## 5 model 5 100 0.96  22.521685 22.569229  0.50573588 0.5068035 26.132866
##           r          COE       IOA
## 1 1.0000000  0.538289594 0.7691448
## 2 0.8258202  0.233921216 0.6169606
## 3 0.9371237  0.635833987 0.8179170
## 4 0.8142735 -0.009329173 0.4953354
## 5 0.9963753 -0.042044773 0.4789776</code></pre>
<p>It is possible to rank the statistics based on the , which is a good general indicator of model performance.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="sec-modStats.html#cb230-1" aria-hidden="true"></a><span class="kw">modStats</span>(modData, <span class="dt">obs =</span> <span class="st">&quot;obs&quot;</span>, <span class="dt">mod =</span> <span class="st">&quot;mod&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;model&quot;</span>, </span>
<span id="cb230-2"><a href="sec-modStats.html#cb230-2" aria-hidden="true"></a>         <span class="dt">rank.name =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<pre><code>##     model   n FAC2         MB       MGE         NMB      NMGE      RMSE
## 3 model 3 100 0.88   1.013647  7.887325  0.02276196 0.1771139  9.451354
## 1 model 1 100 0.89  10.000000 10.000000  0.22455508 0.2245551 10.000000
## 2 model 2 100 0.79   0.922391 16.592192  0.02071276 0.3725861 19.318041
## 4 model 4 100 0.56 -20.603684 21.860655 -0.46266619 0.4908921 25.758520
## 5 model 5 100 0.96  22.521685 22.569229  0.50573588 0.5068035 26.132866
##           r          COE       IOA
## 3 0.9371237  0.635833987 0.8179170
## 1 1.0000000  0.538289594 0.7691448
## 2 0.8258202  0.233921216 0.6169606
## 4 0.8142735 -0.009329173 0.4953354
## 5 0.9963753 -0.042044773 0.4789776</code></pre>
<p>The <code>modStats</code> function is however much more flexible than
indicated above. While it is useful to calculate model evaluation
statistics in a straightforward way it can be much more informative to
consider the statistics split by different periods.</p>
<p>Data have been assembled from a Defra model evaluation exercise which
consists of hourly O<sub>3</sub> predictions at 15 receptor points around the
UK for 2006. The aim here is not to identify a particular model that
is ‘best’ and for this reason the models are simply referred to as
<code>model 1</code>, <code>model 2</code> and so on. We will aim to make the data more
widely available. However, data set has this form:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="sec-modStats.html#cb232-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;~/My Drive/openair/Data/modelData.RData&quot;</span>)</span>
<span id="cb232-2"><a href="sec-modStats.html#cb232-2" aria-hidden="true"></a><span class="kw">head</span>(modTest)</span></code></pre></div>
<pre><code>##         site                date o3   mod   group
## 1 Aston.Hill 2006-01-01 00:00:00 NA    NA model 1
## 2 Aston.Hill 2006-01-01 01:00:00 74 65.28 model 1
## 3 Aston.Hill 2006-01-01 02:00:00 72 64.64 model 1
## 4 Aston.Hill 2006-01-01 03:00:00 72 64.46 model 1
## 5 Aston.Hill 2006-01-01 04:00:00 70 64.88 model 1
## 6 Aston.Hill 2006-01-01 05:00:00 66 65.80 model 1</code></pre>
<p>There are columns representing the receptor location (<code>site</code>), the
date, measured values (<code>o3</code>), model predictions (<code>mod</code>) and the
model itself (<code>group</code>). There are numerous ways in which the
statistics can be calculated. However, of interest here is how the
models perform at a single receptor by season. The seasonal nature of
O<sub>3</sub> is a very important characteristic and it is worth considering
in more detail. The statistics are easy enough to calculate as shown
below. In this example a subset of the data is selected to consider
only the Harwell site. Second, the <code>type</code> option is used to split
the calculations by season and model. Finally, the statistics are
grouped by the <span class="math inline">\(IOA\)</span> for each season. It is now very easy how model
performance changes by season and which models perform best in each
season.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="sec-modStats.html#cb234-1" aria-hidden="true"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="co">## don&#39;t display too many decimal places</span></span>
<span id="cb234-2"><a href="sec-modStats.html#cb234-2" aria-hidden="true"></a><span class="kw">modStats</span>(<span class="kw">subset</span>(modTest, site <span class="op">==</span><span class="st"> &quot;Harwell&quot;</span>), </span>
<span id="cb234-3"><a href="sec-modStats.html#cb234-3" aria-hidden="true"></a>         <span class="dt">obs =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">mod =</span> <span class="st">&quot;mod&quot;</span>,</span>
<span id="cb234-4"><a href="sec-modStats.html#cb234-4" aria-hidden="true"></a>         <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;group&quot;</span>), <span class="dt">rank =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 36 x 12
## # Groups:   season [4]
##    season group     n  FAC2     MB   MGE     NMB  NMGE  RMSE     r      COE
##    &lt;ord&gt;  &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 sprin… mode…  1905 0.875   8.58  16.5  0.137  0.263  21.9 0.576  0.0747 
##  2 sprin… mode…  1905 0.876  -2.04  16.8 -0.0325 0.268  21.8 0.452  0.0584 
##  3 sprin… mode…  1905 0.872  11.9   17.7  0.190  0.282  23.7 0.519  0.00818
##  4 sprin… mode…  1905 0.885   4.98  18.1  0.0793 0.289  23.9 0.361 -0.0151 
##  5 sprin… mode…  1905 0.870  10.8   19.5  0.172  0.311  24.0 0.588 -0.0940 
##  6 sprin… mode…  1825 0.821   7.79  20.0  0.123  0.317  25.8 0.480 -0.118  
##  7 sprin… mode…  1905 0.786 -13.7   21.4 -0.218  0.340  26.1 0.531 -0.195  
##  8 sprin… mode…  1905 0.732 -13.4   24.3 -0.213  0.388  29.8 0.312 -0.362  
##  9 sprin… mode…  1905 0.743   1.01  24.9  0.0161 0.396  32.8 0.264 -0.392  
## 10 summe… mode…  2002 0.918   3.83  15.5  0.0632 0.256  20.9 0.750  0.317  
## # … with 26 more rows, and 1 more variable: IOA &lt;dbl&gt;</code></pre>
<p>Note that it is possible to read the results of the <code>modStats</code>
function into a data frame, which then allows the results to be
plotted. This is generally a good idea when there is a lot of numeric
data to consider and plots will convey the information better.</p>
<p>The <code>modStats</code> function is much more flexible than indicated above
and can be used in lots of interesting ways. The <code>type</code> option in
particular makes it possible to split the statistics in numerous
ways. For example, to summarise the performance of models by site, model and day of the week:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="sec-modStats.html#cb236-1" aria-hidden="true"></a><span class="kw">modStats</span>(modStats, <span class="dt">obs =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">mod =</span> <span class="st">&quot;mod&quot;</span>,</span>
<span id="cb236-2"><a href="sec-modStats.html#cb236-2" aria-hidden="true"></a>         <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;site&quot;</span>, <span class="st">&quot;weekday&quot;</span>, <span class="st">&quot;group&quot;</span>), </span>
<span id="cb236-3"><a href="sec-modStats.html#cb236-3" aria-hidden="true"></a>         <span class="dt">rank =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p>Similarly, if other data are available e.g. meteorological data or
other pollutant species then these variables can also be used to test
models against ranges in their values. This capability is potentially
very useful because it allows for a much more probing analysis into
model evaluation. For example, with wind speed and direction it is
easy to consider how model performance varies by wind speed intervals
or wind sectors, both of which could reveal important performance
characteristics.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-legates2012">
<p>Legates, D. R., and G. J. McCabe. 2012. “A Refined Index of Model Performance: A Rejoinder.” <em>International Journal of Climatology</em>.</p>
</div>
<div id="ref-legates1999">
<p>Legates, D. R., and G. J. McCabe Jr. 1999. “Evaluating the Use of ‘Goodness-of-Fit’ Measures in Hydrologic and Hydroclimatic Model Validation.” <em>Water Resources Research</em> 35 (1): 233–41.</p>
</div>
<div id="ref-Willmott2011">
<p>Willmott, Cort J, Scott M Robeson, and Kenji Matsuura. 2011. “A Refined Index of Model Performance.” <em>International Journal of Climatology</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-conditionalQuantile.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-TaylorDiagram.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/mod-stats.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["openair.pdf", "openair.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
