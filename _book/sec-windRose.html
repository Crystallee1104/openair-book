<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section5 Wind and Pollution Roses | openair</title>
  <meta name="description" content="This will eventually form a book related to the openair R package." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section5 Wind and Pollution Roses | openair" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This will eventually form a book related to the openair R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section5 Wind and Pollution Roses | openair" />
  
  <meta name="twitter:description" content="This will eventually form a book related to the openair R package." />
  

<meta name="author" content="David Carslaw" />


<meta name="date" content="2020-07-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-worldmet.html"/>
<link rel="next" href="sec-polarFreq.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#hello-and-welcome"><i class="fa fa-check"></i>Hello and welcome</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-openair-package.html"><a href="sec-openair-package.html"><i class="fa fa-check"></i><b>2</b> The openair package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-openair-package.html"><a href="sec-openair-package.html#access-to-source-code"><i class="fa fa-check"></i><b>2.1</b> Access to source code</a></li>
<li class="chapter" data-level="2.2" data-path="sec-openair-package.html"><a href="sec-openair-package.html#input-data-requirements"><i class="fa fa-check"></i><b>2.2</b> Input data requirements</a></li>
<li class="chapter" data-level="2.3" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:brief-intr-open"><i class="fa fa-check"></i><b>2.3</b> Brief overview of <code>openair</code></a></li>
<li class="chapter" data-level="2.4" data-path="sec-openair-package.html"><a href="sec-openair-package.html#the-type-option"><i class="fa fa-check"></i><b>2.4</b> The <code>type</code> option</a></li>
<li class="chapter" data-level="2.5" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:font-size"><i class="fa fa-check"></i><b>2.5</b> Controlling font size</a></li>
<li class="chapter" data-level="2.6" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:colours"><i class="fa fa-check"></i><b>2.6</b> Using colours</a></li>
<li class="chapter" data-level="2.7" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:quickText"><i class="fa fa-check"></i><b>2.7</b> Automatic text formatting</a></li>
<li class="chapter" data-level="2.8" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:multiple-plots-page"><i class="fa fa-check"></i><b>2.8</b> Multiple plots on a page</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>3</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>3.1</b> Accessing data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>3.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="3.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>3.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>4</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>4.1</b> The <code>worldmet</code> package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>5</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>5.1</b> Example of use</a></li>
<li class="chapter" data-level="5.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>5.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html"><i class="fa fa-check"></i><b>6</b> Polar frequencies</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html#sec:polarFreqBack"><i class="fa fa-check"></i><b>6.1</b> Background and examples</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>7</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>7.2</b> Examples</a></li>
<li class="chapter" data-level="7.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>7.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>8</b> Polar plots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>8.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="8.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>8.2</b> Examples</a></li>
<li class="chapter" data-level="8.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>8.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="8.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>8.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="8.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>8.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="8.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>8.6</b> Clustering</a></li>
<li class="chapter" data-level="8.7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plots-on-an-interactive-map"><i class="fa fa-check"></i><b>8.7</b> Polar plots on an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>9</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>9.1</b> Purpose</a></li>
<li class="chapter" data-level="9.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>9.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>10</b> Time series plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>10.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>11</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>11.1</b> Purpose</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>11.2</b> Applications</a></li>
<li class="chapter" data-level="11.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>11.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>12</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>12.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>13</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>13.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="13.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>13.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html"><i class="fa fa-check"></i><b>14</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterPurpose"><i class="fa fa-check"></i><b>14.1</b> Purpose</a></li>
<li class="chapter" data-level="14.2" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterEx"><i class="fa fa-check"></i><b>14.2</b> Examples</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:hexbin"><i class="fa fa-check"></i><b>14.2.1</b> Hexaganol binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>15</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>15.1</b> Purpose</a></li>
<li class="chapter" data-level="15.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>15.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>16</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>16.1</b> Trend estimates</a></li>
<li class="chapter" data-level="16.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>16.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>16.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>17</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="17.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>17.1</b> Background</a></li>
<li class="chapter" data-level="17.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>17.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="17.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>17.3</b> Seasonal averages</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html"><i class="fa fa-check"></i><b>18</b> Trajectory analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#plotting-trajectories"><i class="fa fa-check"></i><b>18.1</b> Plotting trajectories</a></li>
<li class="chapter" data-level="18.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajLevel"><i class="fa fa-check"></i><b>18.2</b> Trajectory gridded frequencies</a></li>
<li class="chapter" data-level="18.3" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#trajectory-source-contribution-functions"><i class="fa fa-check"></i><b>18.3</b> Trajectory source contribution functions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#identifying-the-contribution-of-high-concentration-back-trajectories"><i class="fa fa-check"></i><b>18.3.1</b> Identifying the contribution of high concentration back trajectories</a></li>
<li class="chapter" data-level="18.3.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#allocating-trajectories-to-different-wind-sectors"><i class="fa fa-check"></i><b>18.3.2</b> Allocating trajectories to different wind sectors</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#potential-source-contribution-function-pscf"><i class="fa fa-check"></i><b>18.4</b> Potential Source Contribution Function (PSCF)</a></li>
<li class="chapter" data-level="18.5" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#concentration-weighted-trajectory-cwt"><i class="fa fa-check"></i><b>18.5</b> Concentration Weighted Trajectory (CWT)</a></li>
<li class="chapter" data-level="18.6" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajCluster"><i class="fa fa-check"></i><b>18.6</b> Trajectory clustering</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html"><i class="fa fa-check"></i><b>19</b> Conditional quantiles</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalQuantileBack"><i class="fa fa-check"></i><b>19.1</b> Background</a></li>
<li class="chapter" data-level="19.2" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalEval"><i class="fa fa-check"></i><b>19.2</b> Conditional evaluation</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sec-modStats.html"><a href="sec-modStats.html"><i class="fa fa-check"></i><b>20</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModBack"><i class="fa fa-check"></i><b>20.1</b> Background</a></li>
<li class="chapter" data-level="20.2" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModEx"><i class="fa fa-check"></i><b>20.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html"><i class="fa fa-check"></i><b>21</b> Taylor Diagam</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#sec:TaylorBack"><i class="fa fa-check"></i><b>21.1</b> Background</a></li>
<li class="chapter" data-level="21.2" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#examples-of-taylor-diagrams"><i class="fa fa-check"></i><b>21.2</b> Examples of Taylor Diagrams</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sec-utility.html"><a href="sec-utility.html"><i class="fa fa-check"></i><b>22</b> Utility functions</a>
<ul>
<li class="chapter" data-level="22.1" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectByDate"><i class="fa fa-check"></i><b>22.1</b> Selecting data by date</a></li>
<li class="chapter" data-level="22.2" data-path="sec-utility.html"><a href="sec-utility.html#sec:cutData"><i class="fa fa-check"></i><b>22.2</b> Making intervals — <code>cutData</code></a></li>
<li class="chapter" data-level="22.3" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectRunning"><i class="fa fa-check"></i><b>22.3</b> Selecting run lengths of values above a threshold — pollution episodes</a></li>
<li class="chapter" data-level="22.4" data-path="sec-utility.html"><a href="sec-utility.html#sec:rollingMean"><i class="fa fa-check"></i><b>22.4</b> Calculating rolling means</a></li>
<li class="chapter" data-level="22.5" data-path="sec-utility.html"><a href="sec-utility.html#sec:timeAverage"><i class="fa fa-check"></i><b>22.5</b> Aggregating data by different time intervals</a></li>
<li class="chapter" data-level="22.6" data-path="sec-utility.html"><a href="sec-utility.html#sec:calcPercentile"><i class="fa fa-check"></i><b>22.6</b> Calculating percentiles</a></li>
<li class="chapter" data-level="22.7" data-path="sec-utility.html"><a href="sec-utility.html#sec:corPlot"><i class="fa fa-check"></i><b>22.7</b> Correlation matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html"><i class="fa fa-check"></i><b>A</b> Annotating openair plots</a>
<ul>
<li class="chapter" data-level="A.1" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text"><i class="fa fa-check"></i><b>A.1</b> Adding text</a></li>
<li class="chapter" data-level="A.2" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text-and-a-shaded-area"><i class="fa fa-check"></i><b>A.2</b> Adding text and a shaded area</a></li>
<li class="chapter" data-level="A.3" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-an-arrow"><i class="fa fa-check"></i><b>A.3</b> Adding an arrow</a></li>
<li class="chapter" data-level="A.4" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-a-reference-line-and-text"><i class="fa fa-check"></i><b>A.4</b> Adding a reference line and text</a></li>
<li class="chapter" data-level="A.5" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#highlight-a-specific-point"><i class="fa fa-check"></i><b>A.5</b> Highlight a specific point</a></li>
<li class="chapter" data-level="A.6" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-a-filled-polygon"><i class="fa fa-check"></i><b>A.6</b> Add a filled polygon</a></li>
<li class="chapter" data-level="A.7" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-air-quality-bands-as-polygons"><i class="fa fa-check"></i><b>A.7</b> Add air quality bands as polygons</a></li>
<li class="chapter" data-level="A.8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>A.8</b> Polar plot examples</a></li>
<li class="chapter" data-level="A.9" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#using-grid-graphics-identify-locations-interactively"><i class="fa fa-check"></i><b>A.9</b> Using grid graphics — identify locations interactively</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">openair</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:windRose" class="section level1" number="5">
<h1><span class="header-section-number">Section5</span> Wind and Pollution Roses</h1>
<p>The wind rose is a very useful way of summarising meteorological
data. It is particularly useful for showing how wind speed and wind
direction conditions vary by year. The <code>windRose</code> function can
plot wind roses in a variety of ways: summarising all available wind
speed and wind direction data, plotting individual wind roses by year,
and also by month. The latter is useful for considering how
meteorological conditions vary by season.</p>
<p>Data are summarised by direction, typically by 45 or 30<span class="math inline">\(^\circ\)</span>
and by different wind speed categories. Typically, wind speeds are
represented by different width ‘paddles’. The plots show the
proportion (here represented as a percentage) of time that the wind is
from a certain angle and wind speed range.</p>
<p>The <code>windRose</code> function also calculates the percentage of
‘calms’ i.e. when the wind speed is zero. UK Met Office data assigns
these periods to 0 degrees wind direction with valid northerly winds
being assigned to 360<span class="math inline">\(^\circ\)</span>.</p>
<p>The <code>windRose</code> function will also correct for bias when wind
directions are rounded to the nearest 10 degrees but are displayed at
angles that 10 degrees is not exactly divisible into e.g. 22.5<span class="math inline">\(^\circ\)</span>. When such data are binned, some angles i.e. N, E, S, W will
comprise three intervals whereas others will comprise two, which can
lead to significant bias. This issue and its solution is discussed by
<span class="citation">Droppo and Napier (<a href="#ref-droppo2008" role="doc-biblioref">2008</a>)</span> and <span class="citation">Applequist (<a href="#ref-applequist2012" role="doc-biblioref">2012</a>)</span>.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
<span class="pkg">openair</span> uses a simple method to correct for the bias by globally
rescaling the count in each wind direction bin by the number of
directions it represents relative to the average. Thus, the primary
four directions are each reduced by a factor of 0.75 and the remaining
12 directions are multiplied by 1.125.</p>
<div id="example-of-use" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Example of use</h2>
<p>First we load the packages:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sec-windRose.html#cb30-1" aria-hidden="true"></a><span class="kw">library</span>(openair)</span>
<span id="cb30-2"><a href="sec-windRose.html#cb30-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p>The function is very simply called as shown for Figure
<a href="sec-windRose.html#fig:windrose">5.1</a>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sec-windRose.html#cb31-1" aria-hidden="true"></a><span class="kw">windRose</span>(mydata)</span></code></pre></div>
<div class="figure"><span id="fig:windrose"></span>
<img src="openair_files/figure-html/windrose-1.png" alt="Use of `windRose` function to plot wind speed/direction frequencies. Wind speeds are split into the intervals shown by the scale in each panel. The grey circles show the % frequencies." width="50%" />
<p class="caption">
Figure 5.1: Use of <code>windRose</code> function to plot wind speed/direction frequencies. Wind speeds are split into the intervals shown by the scale in each panel. The grey circles show the % frequencies.
</p>
</div>
<p>Figure <a href="sec-windRose.html#fig:windRoseyear">5.2</a> highlights some interesting differences
between the years. In 2000, for example, there were numerous occasions
when the wind was from the SSW and 2003 clearly had more occasions
when the wind was easterly. It can also be useful to use <code>type = "month"</code> to get an idea of how wind speed and direction vary
seasonally.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="sec-windRose.html#cb32-1" aria-hidden="true"></a><span class="kw">windRose</span>(mydata, <span class="dt">type =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>))</span></code></pre></div>
<div class="figure"><span id="fig:windRoseyear"></span>
<img src="openair_files/figure-html/windRoseyear-1.png" alt="Use of `windRose` function to plot wind speed/direction frequencies by year. Wind speeds are split into the intervals shown by the scale in each panel. The grey circles show the 10 and 20% frequencies." width="960" />
<p class="caption">
Figure 5.2: Use of <code>windRose</code> function to plot wind speed/direction frequencies by year. Wind speeds are split into the intervals shown by the scale in each panel. The grey circles show the 10 and 20% frequencies.
</p>
</div>
<p>The <code>type</code> option is very flexible in <span class="pkg">openair</span> and can be used to
quickly consider the dependencies between
variables. Section <a href="sec-utility.html#sec:cutData">22.2</a> describes the basis of this option in
<span class="pkg">openair</span> plot. As an example, consider the question: what are the
meteorological conditions that control high and low concentrations of
PM<sub>10</sub>? By setting <code>type = "pm10"</code>, <span class="pkg">openair</span> will split the PM<sub>10</sub>
concentrations into four <em>quantiles</em> i.e. roughly equal numbers
of points in each level. The plot will then show four different wind
roses for each quantile level, although the default number of levels
can be set by the user — see <code>?cutData</code> for more
details. Figure <a href="sec-windRose.html#fig:windRsPM10">5.3</a> shows the results of setting
<code>type = "pm10"</code>. For the lowest concentrations of PM<sub>10</sub> the wind
direction is dominated by northerly winds, and relatively low wind
speeds. By contrast, the highest concentrations (plot furthest right)
are dominated by relatively strong winds from the south-west. It is
therefore very easy to obtain a good idea about the conditions that
tend to lead to high (or low) concentrations of a
pollutant. Furthermore, the <code>type</code> option is available in almost
all <span class="pkg">openair</span> functions.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sec-windRose.html#cb33-1" aria-hidden="true"></a><span class="kw">windRose</span>(mydata, <span class="dt">type =</span> <span class="st">&quot;pm10&quot;</span>, <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span id="fig:windRsPM10"></span>
<img src="openair_files/figure-html/windRsPM10-1.png" alt="Wind rose for four different levels of PM~10~ concentration. The levels are defined as the four *quantiles* of PM~10~ concentration and the ranges are shown on each of the plot labels." width="960" />
<p class="caption">
Figure 5.3: Wind rose for four different levels of PM<sub>10</sub> concentration. The levels are defined as the four <em>quantiles</em> of PM<sub>10</sub> concentration and the ranges are shown on each of the plot labels.
</p>
</div>
<p>A comparison of the effect that bias has can be seen by plotting the
following. Note the prominent frequencies for W, E and N in particular
that are due to the bias issue discussed by <span class="citation">Applequist (<a href="#ref-applequist2012" role="doc-biblioref">2012</a>)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sec-windRose.html#cb34-1" aria-hidden="true"></a><span class="co">## no bias correction</span></span>
<span id="cb34-2"><a href="sec-windRose.html#cb34-2" aria-hidden="true"></a><span class="kw">windRose</span>(mydata, <span class="dt">angle =</span> <span class="fl">22.5</span>, <span class="dt">bias.corr =</span> <span class="ot">FALSE</span>)</span>
<span id="cb34-3"><a href="sec-windRose.html#cb34-3" aria-hidden="true"></a></span>
<span id="cb34-4"><a href="sec-windRose.html#cb34-4" aria-hidden="true"></a><span class="co">## bias correction (the default)</span></span>
<span id="cb34-5"><a href="sec-windRose.html#cb34-5" aria-hidden="true"></a><span class="kw">windRose</span>(mydata, <span class="dt">angle =</span> <span class="fl">22.5</span>)</span></code></pre></div>
<p><code>pollutionRose</code> is a variant of <code>windRose</code> that is useful for
considering pollutant concentrations by wind direction, or more
specifically the percentage time the concentration is in a particular
range. This type of approach can be very informative for air
pollutant species, as demonstrated by Ronald Henry and co-authors in <span class="citation">Henry et al. (<a href="#ref-henry2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>You can produce similar pollution roses using the <code>pollutionRose</code>
function in recent versions of <span class="pkg">openair</span>, e.g. as in Figure
<a href="sec-windRose.html#fig:pollutionrose1">5.4</a>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sec-windRose.html#cb35-1" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;nox&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:pollutionrose1"></span>
<img src="openair_files/figure-html/pollutionrose1-1.png" alt="NO~x~ pollution rose produced using  `pollutionRose` and default `pollutionRose` settings." width="50%" />
<p class="caption">
Figure 5.4: NO<sub>x</sub> pollution rose produced using <code>pollutionRose</code> and default <code>pollutionRose</code> settings.
</p>
</div>
<p><code>pollutionRose</code> is <em>wrapper</em> for <code>windRose</code>. It simply
replaces the wind speed data series in the supplied data set with
another variable using the argument <code>pollutant</code> before passing
that on to <code>windRose</code>. It also modifies <code>breaks</code> to estimate a
sensible set of break points for that pollutant and uses a slightly
different set of default options (key to right, wedge style plot) but
otherwise handles arguments just like the parent <code>windRose</code>
function.</p>
<p>While Figure <a href="sec-windRose.html#fig:pollutionrose1">5.4</a> indicates that higher NO<sub>x</sub>
concentrations are also associated with the SW, conditioning allows
you to be much informative. For example, conditioning by SO<sub>2</sub>
(Figure <a href="sec-windRose.html#fig:pollutionrose2">5.5</a> demonstrates that higher NO<sub>x</sub>
concentrations are associated with the SW and much of the higher
SO<sub>2</sub> concentrations. However, it also highlights a notable NO<sub>x</sub>
contribution from the E, most apparent at highest SO<sub>2</sub>
concentrations that is obscured in Figure <a href="sec-windRose.html#fig:pollutionrose1">5.4</a> by a
relatively high NO<sub>x</sub> background (Figure <a href="sec-windRose.html#fig:pollutionrose2">5.5</a>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="sec-windRose.html#cb36-1" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;nox&quot;</span>, </span>
<span id="cb36-2"><a href="sec-windRose.html#cb36-2" aria-hidden="true"></a>              <span class="dt">type =</span> <span class="st">&quot;so2&quot;</span>, </span>
<span id="cb36-3"><a href="sec-windRose.html#cb36-3" aria-hidden="true"></a>              <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span id="fig:pollutionrose2"></span>
<img src="openair_files/figure-html/pollutionrose2-1.png" alt="NO~x~ pollution rose conditioned by SO~2~ concentration." width="960" />
<p class="caption">
Figure 5.5: NO<sub>x</sub> pollution rose conditioned by SO<sub>2</sub> concentration.
</p>
</div>
<p><code>pollutionRose</code> can also usefully be used to show which wind
directions dominate the overall concentrations. By supplying the
option <code>statistic = "prop.mean"</code> (proportion contribution to the
mean), a good idea can be gained as to which wind directions
contribute most to overall concentrations, as well as providing
information on the different concentration levels. A simple plot is
shown in Figure <a href="sec-windRose.html#fig:pollRoseAttr">5.6</a>, which clearly shows the dominance
of south-westerly winds controlling the overall mean NO<sub>x</sub>
concentrations at this site. Indeed, almost half the overall NO<sub>x</sub>
concentration is contributed by two wind sectors to the
south-west. The <code>polarFreq</code> function can also show this sort of
information, but the pollution rose is more effective because both
length and colour are used to show the contribution. These plots are
very useful for understanding which wind directions control the
overall mean concentrations.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sec-windRose.html#cb37-1" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">statistic =</span> <span class="st">&quot;prop.mean&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:pollRoseAttr"></span>
<img src="openair_files/figure-html/pollRoseAttr-1.png" alt="Pollution rose showing which wind directions contribute most to overall mean concentrations." width="50%" />
<p class="caption">
Figure 5.6: Pollution rose showing which wind directions contribute most to overall mean concentrations.
</p>
</div>
<p>It is sometimes useful to more clearly understand the contributions
from wind directions that have low frequencies. For example, for a
pollution rose of SO<sub>2</sub> there are few occurrences of easterly winds
making it difficult to see how the concentration intervals are made
up. Try:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="sec-windRose.html#cb38-1" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;so2&quot;</span>, <span class="dt">seg =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>However, each wind sector can be normalised to give a probability
between 0 and 1 to help show the variation within each wind sector
more clearly. An example is shown in Figure <a href="sec-windRose.html#fig:pollutionroseNorm">5.7</a>
where for easterly winds it is now clearer that a greater proportion
of the time the concentration is made up of high SO<sub>2</sub>
concentrations. In this plot each wind sector is scaled between 0 and
1. Also shown with a black like is an indication of the wind direction
frequency to remind us that winds from the east occur with a low
frequency.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="sec-windRose.html#cb39-1" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;so2&quot;</span>, <span class="dt">normalise =</span> <span class="ot">TRUE</span>, <span class="dt">seg =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span id="fig:pollutionroseNorm"></span>
<img src="openair_files/figure-html/pollutionroseNorm-1.png" alt="SO~2~ pollution rose produced using `pollutionRose` normalised by each wind sector." width="50%" />
<p class="caption">
Figure 5.7: SO<sub>2</sub> pollution rose produced using <code>pollutionRose</code> normalised by each wind sector.
</p>
</div>
</div>
<div id="sec:comp-met" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Comparing two meteorological data sets</h2>
<p>The <code>pollutionRose</code> function is also useful for comparing two
meteorological data sets. In this case a ‘reference’ data set is
compared with a second data set. There are many reasons for doing so
e.g. to see how one site compares with another or for meteorological
model evaluation (more on that in later sections). In this case,
<code>ws</code> and <code>wd</code> are considered to the the reference data sets
with which a second set of wind speed and wind directions are to be
compared (<code>ws2</code> and <code>wd2</code>). The first set of values is
subtracted from the second and the differences compared. If for
example, <code>wd2</code> was biased positive compared with <code>wd</code> then
<code>pollutionRose</code> will show the bias in polar coordinates. In its
default use, wind direction bias is colour-coded to show negative bias
in one colour and positive bias in another.</p>
<p>Note that this plot is mostly aimed at showing wind direction
biases. It does also show the wind speed bias <em>but only if there
is a wind direction bias also</em>. However, in most practical
situations the plot should show both wind speed and direction biases
together. An example of a situation where no wind speed bias would be
shown would be for westerly winds where there was absolutely no bias
between two data sets in terms of westerly wind direction but there
was a difference in wind speed. Users should be aware of this limitation.</p>
<p>In the next example, some artificial wind direction data are generated
by adding a positive bias of 30~degrees with some normally distributed
scatter. Also, the wind speed data are given a positive bias. The
results are shown in Figure <a href="sec-windRose.html#fig:pollRoseComp">5.8</a>. The Figure clearly
shows the mean positive bias in wind direction i.e. the direction is
displaced from north (no bias). The colour scale also shows the extent
to which wind speeds are biased i.e. there is a higher proportion of
positively biased wind speeds shown by the red colour compared with the
negatively biased shown in blue. Also shown in Figure
<a href="sec-windRose.html#fig:pollRoseComp">5.8</a> is the mean wind speed and direction bias
as numerical values.</p>
<p>Note that the <code>type</code> option can be used in Figure
<a href="sec-windRose.html#fig:pollRoseComp">5.8</a> e.g. <code>type = "month"</code> to split the
analysis in useful ways. This is useful if one wanted to see whether a
site or the output from a model was biased for different periods. For
example, <code>type = "daylight"</code> would show whether there are biases
between nighttime and daytime conditions.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sec-windRose.html#cb40-1" aria-hidden="true"></a><span class="co">## $example of comparing 2 met sites</span></span>
<span id="cb40-2"><a href="sec-windRose.html#cb40-2" aria-hidden="true"></a><span class="co">## first we will make some new ws/wd data with a postive bias</span></span>
<span id="cb40-3"><a href="sec-windRose.html#cb40-3" aria-hidden="true"></a>mydata &lt;-<span class="st"> </span><span class="kw">mutate</span>(mydata,</span>
<span id="cb40-4"><a href="sec-windRose.html#cb40-4" aria-hidden="true"></a>                    <span class="dt">ws2 =</span> ws <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">nrow</span>(mydata)) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb40-5"><a href="sec-windRose.html#cb40-5" aria-hidden="true"></a>                    <span class="dt">wd2 =</span> wd <span class="op">+</span><span class="st"> </span><span class="dv">30</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">nrow</span>(mydata)) <span class="op">+</span><span class="st"> </span><span class="dv">30</span>)</span>
<span id="cb40-6"><a href="sec-windRose.html#cb40-6" aria-hidden="true"></a></span>
<span id="cb40-7"><a href="sec-windRose.html#cb40-7" aria-hidden="true"></a><span class="co">## need to correct negative wd</span></span>
<span id="cb40-8"><a href="sec-windRose.html#cb40-8" aria-hidden="true"></a>id &lt;-<span class="st"> </span><span class="kw">which</span>(mydata<span class="op">$</span>wd2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb40-9"><a href="sec-windRose.html#cb40-9" aria-hidden="true"></a>mydata<span class="op">$</span>wd2[id] &lt;-<span class="st"> </span>mydata<span class="op">$</span>wd2[id] <span class="op">+</span><span class="st"> </span><span class="dv">360</span></span>
<span id="cb40-10"><a href="sec-windRose.html#cb40-10" aria-hidden="true"></a></span>
<span id="cb40-11"><a href="sec-windRose.html#cb40-11" aria-hidden="true"></a><span class="co">## results show postive bias in wd and ws</span></span>
<span id="cb40-12"><a href="sec-windRose.html#cb40-12" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, </span>
<span id="cb40-13"><a href="sec-windRose.html#cb40-13" aria-hidden="true"></a>              <span class="dt">ws =</span> <span class="st">&quot;ws&quot;</span>, </span>
<span id="cb40-14"><a href="sec-windRose.html#cb40-14" aria-hidden="true"></a>              <span class="dt">wd =</span> <span class="st">&quot;wd&quot;</span>, </span>
<span id="cb40-15"><a href="sec-windRose.html#cb40-15" aria-hidden="true"></a>              <span class="dt">ws2 =</span> <span class="st">&quot;ws2&quot;</span>, </span>
<span id="cb40-16"><a href="sec-windRose.html#cb40-16" aria-hidden="true"></a>              <span class="dt">wd2 =</span> <span class="st">&quot;wd2&quot;</span>, </span>
<span id="cb40-17"><a href="sec-windRose.html#cb40-17" aria-hidden="true"></a>              <span class="dt">grid.line =</span> <span class="dv">5</span>)</span></code></pre></div>
<div class="figure"><span id="fig:pollRoseComp"></span>
<img src="openair_files/figure-html/pollRoseComp-1.png" alt="Pollution rose showing the difference between two  meteorological data sets. The colours are used to show whether data tend to be positively or negatively biased with respect to the reference data set." width="50%" />
<p class="caption">
Figure 5.8: Pollution rose showing the difference between two meteorological data sets. The colours are used to show whether data tend to be positively or negatively biased with respect to the reference data set.
</p>
</div>
<p>An example of using user-supplied breaks is shown in Figure
<a href="sec-windRose.html#fig:pollRoseComp2">5.9</a>. In this case six intervals are chosen
including one that spans -0.5 to +0.5 that is useful to show wind
speeds that do not change.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sec-windRose.html#cb41-1" aria-hidden="true"></a><span class="co">## add some wd bias to some nighttime hours</span></span>
<span id="cb41-2"><a href="sec-windRose.html#cb41-2" aria-hidden="true"></a>id &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">as.numeric</span>(<span class="kw">format</span>(mydata<span class="op">$</span>date, <span class="st">&quot;%H&quot;</span>)) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb41-3"><a href="sec-windRose.html#cb41-3" aria-hidden="true"></a>mydata<span class="op">$</span>wd2[id] &lt;-<span class="st"> </span>mydata<span class="op">$</span>wd[id] <span class="op">+</span><span class="st"> </span><span class="dv">30</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(id)) <span class="op">+</span><span class="st"> </span><span class="dv">120</span></span>
<span id="cb41-4"><a href="sec-windRose.html#cb41-4" aria-hidden="true"></a>id &lt;-<span class="st"> </span><span class="kw">which</span>(mydata<span class="op">$</span>wd2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb41-5"><a href="sec-windRose.html#cb41-5" aria-hidden="true"></a>mydata<span class="op">$</span>wd2[id] &lt;-<span class="st"> </span>mydata<span class="op">$</span>wd2[id] <span class="op">+</span><span class="st"> </span><span class="dv">360</span></span>
<span id="cb41-6"><a href="sec-windRose.html#cb41-6" aria-hidden="true"></a></span>
<span id="cb41-7"><a href="sec-windRose.html#cb41-7" aria-hidden="true"></a><span class="kw">pollutionRose</span>(mydata, <span class="dt">ws =</span> <span class="st">&quot;ws&quot;</span>, <span class="dt">wd =</span> <span class="st">&quot;wd&quot;</span>, <span class="dt">ws2 =</span> <span class="st">&quot;ws2&quot;</span>, <span class="dt">wd2 =</span> <span class="st">&quot;wd2&quot;</span>,</span>
<span id="cb41-8"><a href="sec-windRose.html#cb41-8" aria-hidden="true"></a>              <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">11</span>, <span class="dv">-2</span>, <span class="dv">-1</span>, <span class="fl">-0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">11</span>),</span>
<span id="cb41-9"><a href="sec-windRose.html#cb41-9" aria-hidden="true"></a>              <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;firebrick&quot;</span>),</span>
<span id="cb41-10"><a href="sec-windRose.html#cb41-10" aria-hidden="true"></a>              <span class="dt">grid.line =</span> <span class="dv">5</span>, <span class="dt">type =</span> <span class="st">&quot;daylight&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:pollRoseComp2"></span>
<img src="openair_files/figure-html/pollRoseComp2-1.png" alt="Pollution rose showing the difference between two meteorological data sets. The colours are used to show whether data tend to be positively or negatively biased with respect to the reference data set. In this case the example shows how to use user-defined breaks and split the data by day/night for a latitude assumed to be London." width="80%" />
<p class="caption">
Figure 5.9: Pollution rose showing the difference between two meteorological data sets. The colours are used to show whether data tend to be positively or negatively biased with respect to the reference data set. In this case the example shows how to use user-defined breaks and split the data by day/night for a latitude assumed to be London.
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-applequist2012">
<p>Applequist, Scott. 2012. “Wind Rose Bias Correction.” <em>Journal of Applied Meteorology and Climatology</em> 51 (7): 1305–9.</p>
</div>
<div id="ref-droppo2008">
<p>Droppo, James G, and Bruce A Napier. 2008. “Wind Direction Bias in Generating Wind Roses and Conducting Sector-Based Air Dispersion Modeling.” <em>Journal of the Air &amp; Waste Management Association</em> 58 (7): 913–18.</p>
</div>
<div id="ref-henry2009">
<p>Henry, Ronald, Gary A. Norris, Ram Vedantham, and Jay R. Turner. 2009. “Source Region Identification Using Kernel Smoothing.” Article. <em>Environmental Science &amp; Technology</em> 43 (11): 4090–7. <a href="https://doi.org/%7B10.1021/es8011723%7D">https://doi.org/{10.1021/es8011723}</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>Thanks to Philippe
Barneoud of Environment Canada for pointing this issue out.<a href="sec-windRose.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-worldmet.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-polarFreq.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/wind-roses.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["openair.pdf", "openair.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
