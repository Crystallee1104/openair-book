<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 13 Trend heat maps | The openair book</title>
  <meta name="description" content="Analysing air quality data with the openair package" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 13 Trend heat maps | The openair book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Analysing air quality data with the openair package" />
  <meta name="github-repo" content="davidcarslaw/openair-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 13 Trend heat maps | The openair book" />
  
  <meta name="twitter:description" content="Analysing air quality data with the openair package" />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="David C. Carslaw" />


<meta name="date" content="2020-07-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-timeProp.html"/>
<link rel="next" href="sec-calendarPlot.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#hello-and-welcome"><i class="fa fa-check"></i>Hello and welcome</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-openair-package.html"><a href="sec-openair-package.html"><i class="fa fa-check"></i><b>2</b> The openair package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-openair-package.html"><a href="sec-openair-package.html#installation-and-code-access"><i class="fa fa-check"></i><b>2.1</b> Installation and code access</a></li>
<li class="chapter" data-level="2.2" data-path="sec-openair-package.html"><a href="sec-openair-package.html#input-data-requirements"><i class="fa fa-check"></i><b>2.2</b> Input data requirements</a></li>
<li class="chapter" data-level="2.3" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:brief-intr-open"><i class="fa fa-check"></i><b>2.3</b> Brief overview of openair</a></li>
<li class="chapter" data-level="2.4" data-path="sec-openair-package.html"><a href="sec-openair-package.html#the-type-option"><i class="fa fa-check"></i><b>2.4</b> The type option</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sec-openair-package.html"><a href="sec-openair-package.html#make-your-own-type"><i class="fa fa-check"></i><b>2.4.1</b> Make your own type</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:font-size"><i class="fa fa-check"></i><b>2.5</b> Controlling font size</a></li>
<li class="chapter" data-level="2.6" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:colours"><i class="fa fa-check"></i><b>2.6</b> Using colours</a></li>
<li class="chapter" data-level="2.7" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:quickText"><i class="fa fa-check"></i><b>2.7</b> Automatic text formatting</a></li>
<li class="chapter" data-level="2.8" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:multiple-plots-page"><i class="fa fa-check"></i><b>2.8</b> Multiple plots on a page</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>3</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>3.1</b> Accessing data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>3.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="3.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>3.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>4</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>4.1</b> The worldmet package</a></li>
<li class="chapter" data-level="4.2" data-path="sec-worldmet.html"><a href="sec-worldmet.html#sec:link-aq"><i class="fa fa-check"></i><b>4.2</b> Linking with air quality data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>5</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>5.1</b> Example of use</a></li>
<li class="chapter" data-level="5.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>5.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html"><i class="fa fa-check"></i><b>6</b> Polar frequencies</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html#sec:polarFreqBack"><i class="fa fa-check"></i><b>6.1</b> Background and examples</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>7</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>7.2</b> Examples</a></li>
<li class="chapter" data-level="7.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>7.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>8</b> Polar plots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>8.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="8.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>8.2</b> Examples</a></li>
<li class="chapter" data-level="8.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>8.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="8.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>8.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="8.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>8.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="8.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>8.6</b> Clustering</a></li>
<li class="chapter" data-level="8.7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plots-on-an-interactive-map"><i class="fa fa-check"></i><b>8.7</b> Polar plots on an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>9</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>9.1</b> Purpose</a></li>
<li class="chapter" data-level="9.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>9.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>10</b> Time series plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>10.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>11</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>11.1</b> Purpose</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>11.2</b> Applications</a></li>
<li class="chapter" data-level="11.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>11.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>12</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>12.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>13</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>13.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="13.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>13.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>14</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>14.1</b> Purpose</a></li>
<li class="chapter" data-level="14.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>14.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>15</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>15.1</b> Trend estimates</a></li>
<li class="chapter" data-level="15.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>15.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>15.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>16</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>16.1</b> Background</a></li>
<li class="chapter" data-level="16.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>16.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="16.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>16.3</b> Seasonal averages</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html"><i class="fa fa-check"></i><b>17</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="17.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterPurpose"><i class="fa fa-check"></i><b>17.1</b> Purpose</a></li>
<li class="chapter" data-level="17.2" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterEx"><i class="fa fa-check"></i><b>17.2</b> Examples</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:hexbin"><i class="fa fa-check"></i><b>17.2.1</b> Hexaganol binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html"><i class="fa fa-check"></i><b>18</b> Trajectory analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#plotting-trajectories"><i class="fa fa-check"></i><b>18.1</b> Plotting trajectories</a></li>
<li class="chapter" data-level="18.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajLevel"><i class="fa fa-check"></i><b>18.2</b> Trajectory gridded frequencies</a></li>
<li class="chapter" data-level="18.3" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#trajectory-source-contribution-functions"><i class="fa fa-check"></i><b>18.3</b> Trajectory source contribution functions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#identifying-the-contribution-of-high-concentration-back-trajectories"><i class="fa fa-check"></i><b>18.3.1</b> Identifying the contribution of high concentration back trajectories</a></li>
<li class="chapter" data-level="18.3.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#allocating-trajectories-to-different-wind-sectors"><i class="fa fa-check"></i><b>18.3.2</b> Allocating trajectories to different wind sectors</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#potential-source-contribution-function-pscf"><i class="fa fa-check"></i><b>18.4</b> Potential Source Contribution Function (PSCF)</a></li>
<li class="chapter" data-level="18.5" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#concentration-weighted-trajectory-cwt"><i class="fa fa-check"></i><b>18.5</b> Concentration Weighted Trajectory (CWT)</a></li>
<li class="chapter" data-level="18.6" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajCluster"><i class="fa fa-check"></i><b>18.6</b> Trajectory clustering</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html"><i class="fa fa-check"></i><b>19</b> Conditional quantiles</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalQuantileBack"><i class="fa fa-check"></i><b>19.1</b> Background</a></li>
<li class="chapter" data-level="19.2" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalEval"><i class="fa fa-check"></i><b>19.2</b> Conditional evaluation</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sec-modStats.html"><a href="sec-modStats.html"><i class="fa fa-check"></i><b>20</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModBack"><i class="fa fa-check"></i><b>20.1</b> Background</a></li>
<li class="chapter" data-level="20.2" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModEx"><i class="fa fa-check"></i><b>20.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html"><i class="fa fa-check"></i><b>21</b> Taylor Diagam</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#sec:TaylorBack"><i class="fa fa-check"></i><b>21.1</b> Background</a></li>
<li class="chapter" data-level="21.2" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#examples-of-taylor-diagrams"><i class="fa fa-check"></i><b>21.2</b> Examples of Taylor Diagrams</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sec-utility.html"><a href="sec-utility.html"><i class="fa fa-check"></i><b>22</b> Utility functions</a>
<ul>
<li class="chapter" data-level="22.1" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectByDate"><i class="fa fa-check"></i><b>22.1</b> Selecting data by date</a></li>
<li class="chapter" data-level="22.2" data-path="sec-utility.html"><a href="sec-utility.html#sec:cutData"><i class="fa fa-check"></i><b>22.2</b> Making intervals — cutData</a></li>
<li class="chapter" data-level="22.3" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectRunning"><i class="fa fa-check"></i><b>22.3</b> Selecting run lengths of values above a threshold — pollution episodes</a></li>
<li class="chapter" data-level="22.4" data-path="sec-utility.html"><a href="sec-utility.html#sec:rollingMean"><i class="fa fa-check"></i><b>22.4</b> Calculating rolling means</a></li>
<li class="chapter" data-level="22.5" data-path="sec-utility.html"><a href="sec-utility.html#sec:timeAverage"><i class="fa fa-check"></i><b>22.5</b> Aggregating data by different time intervals</a></li>
<li class="chapter" data-level="22.6" data-path="sec-utility.html"><a href="sec-utility.html#sec:calcPercentile"><i class="fa fa-check"></i><b>22.6</b> Calculating percentiles</a></li>
<li class="chapter" data-level="22.7" data-path="sec-utility.html"><a href="sec-utility.html#sec:corPlot"><i class="fa fa-check"></i><b>22.7</b> Correlation matrices</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html"><i class="fa fa-check"></i><b>A</b> Annotating openair plots</a>
<ul>
<li class="chapter" data-level="A.1" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text"><i class="fa fa-check"></i><b>A.1</b> Adding text</a></li>
<li class="chapter" data-level="A.2" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text-and-a-shaded-area"><i class="fa fa-check"></i><b>A.2</b> Adding text and a shaded area</a></li>
<li class="chapter" data-level="A.3" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-an-arrow"><i class="fa fa-check"></i><b>A.3</b> Adding an arrow</a></li>
<li class="chapter" data-level="A.4" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-a-reference-line-and-text"><i class="fa fa-check"></i><b>A.4</b> Adding a reference line and text</a></li>
<li class="chapter" data-level="A.5" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#highlight-a-specific-point"><i class="fa fa-check"></i><b>A.5</b> Highlight a specific point</a></li>
<li class="chapter" data-level="A.6" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-a-filled-polygon"><i class="fa fa-check"></i><b>A.6</b> Add a filled polygon</a></li>
<li class="chapter" data-level="A.7" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-air-quality-bands-as-polygons"><i class="fa fa-check"></i><b>A.7</b> Add air quality bands as polygons</a></li>
<li class="chapter" data-level="A.8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>A.8</b> Polar plot examples</a></li>
<li class="chapter" data-level="A.9" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#using-grid-graphics-identify-locations-interactively"><i class="fa fa-check"></i><b>A.9</b> Using grid graphics — identify locations interactively</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="sec-prod-hyspl-traj.html"><a href="sec-prod-hyspl-traj.html"><i class="fa fa-check"></i><b>B</b> Production of HYSPLIT trajectory files</a></li>
<li class="chapter" data-level="C" data-path="sec-trends-gam.html"><a href="sec-trends-gam.html"><i class="fa fa-check"></i><b>C</b> A closer look at trends</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The openair book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:trendLevel" class="section level1" number="13">
<h1><span class="header-section-number">Section 13</span> Trend heat maps</h1>
<div id="another-way-of-representing-trends" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Another way of representing trends</h2>
<p>The <code>trendLevel</code> function provides a way of rapidly showing a large
amount of data in a condensed way. It is particularly useful for
plotting the level of a value against two categorical variables. These
categorical variables can pre-exist in a data set or be made on the
fly using <span class="pkg">openair</span>. By default it will show the mean value of a
variable against two categorical variables but can also consider a
wider range of statistics e.g. the maximum, frequency, or indeed a
user-defined function. The function is much more flexible than this by
showing temporal data and can plot ‘heat maps’ in many flexible
ways. Both continuous colour scales and user-defined categorical
scales can be used.</p>
<p>The <code>trendLevel</code> function shows how the value of a variable
varies according to intervals of two other variables. The <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>
variables can be categorical (factor or character) or numeric. The
third variable (<span class="math inline">\(z\)</span>) must be numeric and is coloured according to its
value. Despite being called <code>trendLevel</code> the function is flexible
enough to consider a wide range of plotting variables.</p>
<p>If the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables are not categorical they are made so by
splitting the data into quantiles (using <code>cutData</code>). Furthermore, the user can supply as many levels as they wish for the quantile using the option <code>n.levels</code>. Remeber also there are lots of built-in options for <code>x</code> or <code>y</code> based on temporal variations (see Section <a href="sec-utility.html#sec:cutData">22.2</a>) e.g. “month” (the default), “week”, “daylight” and so on.</p>
</div>
<div id="sec:TrendLevelEx" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Examples</h2>
<p>The standard output from <code>trendLevel</code> is shown in Figure
<a href="sec-trendLevel.html#fig:trendLevel1">13.1</a>, which shows the variation in NO<sub>x</sub>
concentrations by year and hour of the day. By default the function will use “month” for the x-axis and “hour” for the y-axis.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="sec-trendLevel.html#cb120-1" aria-hidden="true"></a><span class="kw">library</span>(openair)</span>
<span id="cb120-2"><a href="sec-trendLevel.html#cb120-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb120-3"><a href="sec-trendLevel.html#cb120-3" aria-hidden="true"></a></span>
<span id="cb120-4"><a href="sec-trendLevel.html#cb120-4" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;nox&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:trendLevel1"></span>
<img src="openair_files/figure-html/trendLevel1-1.png" alt="Example output from `trendLevel`" width="90%" />
<p class="caption">
Figure 13.1: Example output from <code>trendLevel</code>
</p>
</div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sec-trendLevel.html#cb121-1" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;wd&quot;</span>, </span>
<span id="cb121-2"><a href="sec-trendLevel.html#cb121-2" aria-hidden="true"></a>           <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb121-3"><a href="sec-trendLevel.html#cb121-3" aria-hidden="true"></a>           <span class="dt">cols =</span> <span class="st">&quot;jet&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:trendLevel2"></span>
<img src="openair_files/figure-html/trendLevel2-1.png" alt="`trendLevel` output with wind direction as `y`." width=".8\textwidth" />
<p class="caption">
Figure 13.2: <code>trendLevel</code> output with wind direction as <code>y</code>.
</p>
</div>
<p>Figure <a href="sec-trendLevel.html#fig:trendLevel3">13.3</a> indicates that the highest NO<sub>x</sub>
concentrations most strongly associate with wind sectors about 200
degrees, appear to be decreasing over the years, but do not appear to
associate with an SO<sub>2</sub> rich NO<sub>x</sub> source. Using <code>type = "so2"</code>
would have conditioned by absolute SO<sub>2</sub> concentration. As both a
moderate contribution from an SO<sub>2</sub> rich source and a high
contribution from an SO<sub>2</sub> poor source could generate similar SO<sub>2</sub>
concentrations, such conditioning can sometimes blur
interpretations. The use of this type of ‘over pollutant’ ratio
reduces this blurring by focusing conditioning on cases when NO<sub>x</sub>
concentrations (be they high or low) associate with relatively high or
low SO<sub>2</sub> concentrations.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="sec-trendLevel.html#cb122-1" aria-hidden="true"></a><span class="co">## new field: so2/nox ratio</span></span>
<span id="cb122-2"><a href="sec-trendLevel.html#cb122-2" aria-hidden="true"></a>mydata &lt;-<span class="st"> </span><span class="kw">mutate</span>(mydata, <span class="dt">ratio =</span>  so2 <span class="op">/</span><span class="st"> </span>nox)</span>
<span id="cb122-3"><a href="sec-trendLevel.html#cb122-3" aria-hidden="true"></a></span>
<span id="cb122-4"><a href="sec-trendLevel.html#cb122-4" aria-hidden="true"></a><span class="co">## condition by mydata$new</span></span>
<span id="cb122-5"><a href="sec-trendLevel.html#cb122-5" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="st">&quot;nox&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;wd&quot;</span>, </span>
<span id="cb122-6"><a href="sec-trendLevel.html#cb122-6" aria-hidden="true"></a>           <span class="dt">type =</span> <span class="st">&quot;ratio&quot;</span>,</span>
<span id="cb122-7"><a href="sec-trendLevel.html#cb122-7" aria-hidden="true"></a>           <span class="dt">cols =</span> <span class="st">&quot;inferno&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:trendLevel3"></span>
<img src="openair_files/figure-html/trendLevel3-1.png" alt="`trendLevel` output with SO~2~ : NO~x~ ratio `type` conditioning." width="80%" />
<p class="caption">
Figure 13.3: <code>trendLevel</code> output with SO<sub>2</sub> : NO<sub>x</sub> ratio <code>type</code> conditioning.
</p>
</div>
<p>The plot can be used in much more flexible ways. Here are some
examples (not plotted):</p>
<p>A plot of mean O<sub>3</sub> concentration shown by season and by
daylight/nighttime hours.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sec-trendLevel.html#cb123-1" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="dt">x =</span> <span class="st">&quot;season&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;daylight&quot;</span>, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>)</span></code></pre></div>
<p>Or by season and hour of the day:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="sec-trendLevel.html#cb124-1" aria-hidden="true"></a>    <span class="kw">trendLevel</span>(mydata, <span class="dt">x =</span> <span class="st">&quot;season&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;hour&quot;</span>, </span>
<span id="cb124-2"><a href="sec-trendLevel.html#cb124-2" aria-hidden="true"></a>               <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>,</span>
<span id="cb124-3"><a href="sec-trendLevel.html#cb124-3" aria-hidden="true"></a>               <span class="dt">cols =</span> <span class="st">&quot;increment&quot;</span>)</span></code></pre></div>
<p>How about NO<sub>x</sub> versus NO<sub>2</sub> coloured by the concentration of O<sub>3</sub>?
<code>scatterPlot</code> could also be used to produce such a plot. However,
one interesting difference with using <code>trendLevel</code> is that the data
are split into quantiles where equal numbers of data exist in each
interval. This approach can make it a bit easier to see the underlying
relationship between variables. A scatter plot may have too much data
to be clear and also outliers (or regions with relatively few data)
that make it harder to see what is going on. The plot generated by the
command below makes it a bit easier to see that it is the higher
quantiles of NO<sub>2</sub> that are associated with higher O<sub>3</sub>
concentration (as well as low NO<sub>x</sub> and NO<sub>2</sub> concentrations).</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sec-trendLevel.html#cb125-1" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>, </span>
<span id="cb125-2"><a href="sec-trendLevel.html#cb125-2" aria-hidden="true"></a>           <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb125-3"><a href="sec-trendLevel.html#cb125-3" aria-hidden="true"></a>           <span class="dt">n.levels =</span> <span class="dv">30</span>, <span class="dt">statistic =</span> <span class="st">&quot;max&quot;</span>, </span>
<span id="cb125-4"><a href="sec-trendLevel.html#cb125-4" aria-hidden="true"></a>           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>))</span></code></pre></div>
<div class="figure"><span id="fig:trendLevelNO2NOx"></span>
<img src="openair_files/figure-html/trendLevelNO2NOx-1.png" alt="`trendLevel` showing NO~x~ against NO~2~, coloured by the concentration of O~3~." width="672" />
<p class="caption">
Figure 13.4: <code>trendLevel</code> showing NO<sub>x</sub> against NO<sub>2</sub>, coloured by the concentration of O<sub>3</sub>.
</p>
</div>
<p>The plot can also be shown by wind direction sector, this time showing
how O<sub>3</sub> varies by weekday, wind direction sector and NO<sub>x</sub> quantile.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sec-trendLevel.html#cb126-1" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;weekday&quot;</span>, <span class="dt">pollutant =</span> <span class="st">&quot;o3&quot;</span>,</span>
<span id="cb126-2"><a href="sec-trendLevel.html#cb126-2" aria-hidden="true"></a>           <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">n.levels =</span> <span class="dv">10</span>, <span class="dt">statistic =</span> <span class="st">&quot;max&quot;</span>,</span>
<span id="cb126-3"><a href="sec-trendLevel.html#cb126-3" aria-hidden="true"></a>           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">type =</span> <span class="st">&quot;wd&quot;</span>)</span></code></pre></div>
<p>By default <code>trendLevel</code> subsamples the plotted <code>pollutant</code> data
by the supplied <code>x</code>, <code>y</code> and <code>type</code> parameters and in each
case calculates the mean. The option <code>statistic</code> has always let
you apply other statistics. For example, <code>trendLevel</code> also
calculated the maximum via the option <code>statistic = "max"</code>. The user
may also use their own statistic function.</p>
<p>As a simple example, consider the above plot which summarises by mean.
This tells us about average concentrations. It might also be useful to
consider a particular percentile of concentrations. This can be done
by defining one’s own function as shown in Figure <a href="sec-trendLevel.html#fig:trendlevel4">13.5</a>.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sec-trendLevel.html#cb127-1" aria-hidden="true"></a><span class="co">## function to estimate 95th percentile</span></span>
<span id="cb127-2"><a href="sec-trendLevel.html#cb127-2" aria-hidden="true"></a>percentile &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">quantile</span>(x, <span class="dt">probs =</span> <span class="fl">0.95</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb127-3"><a href="sec-trendLevel.html#cb127-3" aria-hidden="true"></a></span>
<span id="cb127-4"><a href="sec-trendLevel.html#cb127-4" aria-hidden="true"></a><span class="co">## apply to present plot</span></span>
<span id="cb127-5"><a href="sec-trendLevel.html#cb127-5" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="st">&quot;nox&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;wd&quot;</span>, </span>
<span id="cb127-6"><a href="sec-trendLevel.html#cb127-6" aria-hidden="true"></a>           <span class="dt">type =</span> <span class="st">&quot;ratio&quot;</span>,</span>
<span id="cb127-7"><a href="sec-trendLevel.html#cb127-7" aria-hidden="true"></a>           <span class="dt">cols =</span> <span class="st">&quot;viridis&quot;</span>,</span>
<span id="cb127-8"><a href="sec-trendLevel.html#cb127-8" aria-hidden="true"></a>           <span class="dt">statistic =</span> percentile)</span></code></pre></div>
<div class="figure"><span id="fig:trendlevel4"></span>
<img src="openair_files/figure-html/trendlevel4-1.png" alt="`trendLevel` using locally defined    `statistic`." width="80%" />
<p class="caption">
Figure 13.5: <code>trendLevel</code> using locally defined <code>statistic</code>.
</p>
</div>
<p>This type of flexibility really opens up the potential of the function
as a screening tool for the early stages of data analysis. Increased
control of <code>x</code>, <code>y</code>, <code>type</code> and <code>statistic</code> allow you to
very quick explore your data and develop an understanding of how
different parameters interact. Patterns in <code>trendLevel</code> plots can
also help to direct your <span class="pkg">openair</span> analysis. For example, possible trends
in data conditioned by year would suggest that functions like
<code>smoothTrend</code> or <code>TheilSen</code> could provide further insight.
Likewise, <code>windRose</code> or <code>polarPlot</code> could be useful next steps
if wind speed and direct conditioning produces interesting features.
However, perhaps most interestingly, novel conditioning or the
incorporation of novel parameters in this type of highly flexible function
provides a means of developing new data visualisation and analysis methods.</p>
<p><code>trendLevel</code> can also be used with user defined discrete colour
scales as shown in Figure <a href="sec-trendLevel.html#fig:trendLevelDiscete">13.6</a>. In this case the
default <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables are chosen (month and hour) split by
<code>type</code> (year).</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="sec-trendLevel.html#cb128-1" aria-hidden="true"></a><span class="kw">trendLevel</span>(mydata, <span class="dt">pollutant =</span> <span class="st">&quot;no2&quot;</span>,</span>
<span id="cb128-2"><a href="sec-trendLevel.html#cb128-2" aria-hidden="true"></a>           <span class="dt">x =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb128-3"><a href="sec-trendLevel.html#cb128-3" aria-hidden="true"></a>           <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>,  <span class="dt">statistic =</span> <span class="st">&quot;max&quot;</span>,</span>
<span id="cb128-4"><a href="sec-trendLevel.html#cb128-4" aria-hidden="true"></a>           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>),</span>
<span id="cb128-5"><a href="sec-trendLevel.html#cb128-5" aria-hidden="true"></a>           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>),</span>
<span id="cb128-6"><a href="sec-trendLevel.html#cb128-6" aria-hidden="true"></a>           <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;forestgreen&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb128-7"><a href="sec-trendLevel.html#cb128-7" aria-hidden="true"></a>           <span class="dt">key.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:trendLevelDiscete"></span>
<img src="openair_files/figure-html/trendLevelDiscete-1.png" alt="`trendLevel` plot for maximum NO~2~ concentrations using a user-defined discrete colour scale." width="672" />
<p class="caption">
Figure 13.6: <code>trendLevel</code> plot for maximum NO<sub>2</sub> concentrations using a user-defined discrete colour scale.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-timeProp.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-calendarPlot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/davidcarslaw/openair-book/edit/master/trend-level.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
