<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 17 Scatter plots | The openair book</title>
  <meta name="description" content="This will eventually form a book related to the openair R package." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 17 Scatter plots | The openair book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This will eventually form a book related to the openair R package." />
  <meta name="github-repo" content="davidcarslaw/openair-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 17 Scatter plots | The openair book" />
  
  <meta name="twitter:description" content="This will eventually form a book related to the openair R package." />
  

<meta name="author" content="David C. Carslaw" />


<meta name="date" content="2020-07-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-smoothTrend.html"/>
<link rel="next" href="sec-trajPlot.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The openair book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#hello-and-welcome"><i class="fa fa-check"></i>Hello and welcome</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-openair-package.html"><a href="sec-openair-package.html"><i class="fa fa-check"></i><b>2</b> The openair package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-openair-package.html"><a href="sec-openair-package.html#installation-and-code-access"><i class="fa fa-check"></i><b>2.1</b> Installation and code access</a></li>
<li class="chapter" data-level="2.2" data-path="sec-openair-package.html"><a href="sec-openair-package.html#input-data-requirements"><i class="fa fa-check"></i><b>2.2</b> Input data requirements</a></li>
<li class="chapter" data-level="2.3" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:brief-intr-open"><i class="fa fa-check"></i><b>2.3</b> Brief overview of openair</a></li>
<li class="chapter" data-level="2.4" data-path="sec-openair-package.html"><a href="sec-openair-package.html#the-type-option"><i class="fa fa-check"></i><b>2.4</b> The type option</a></li>
<li class="chapter" data-level="2.5" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:font-size"><i class="fa fa-check"></i><b>2.5</b> Controlling font size</a></li>
<li class="chapter" data-level="2.6" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:colours"><i class="fa fa-check"></i><b>2.6</b> Using colours</a></li>
<li class="chapter" data-level="2.7" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:quickText"><i class="fa fa-check"></i><b>2.7</b> Automatic text formatting</a></li>
<li class="chapter" data-level="2.8" data-path="sec-openair-package.html"><a href="sec-openair-package.html#sec:multiple-plots-page"><i class="fa fa-check"></i><b>2.8</b> Multiple plots on a page</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-importAURN.html"><a href="sec-importAURN.html"><i class="fa fa-check"></i><b>3</b> Accessing UK Air Quality Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-importAURN.html"><a href="sec-importAURN.html#accessing-data"><i class="fa fa-check"></i><b>3.1</b> Accessing data</a></li>
<li class="chapter" data-level="3.2" data-path="sec-importAURN.html"><a href="sec-importAURN.html#site-meta-data"><i class="fa fa-check"></i><b>3.2</b> Site Meta Data</a></li>
<li class="chapter" data-level="3.3" data-path="sec-importAURN.html"><a href="sec-importAURN.html#plot-sites-on-a-map"><i class="fa fa-check"></i><b>3.3</b> Plot Sites on a Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-worldmet.html"><a href="sec-worldmet.html"><i class="fa fa-check"></i><b>4</b> Access meteorological data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-worldmet.html"><a href="sec-worldmet.html#the-worldmet-package"><i class="fa fa-check"></i><b>4.1</b> The worldmet package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-windRose.html"><a href="sec-windRose.html"><i class="fa fa-check"></i><b>5</b> Wind and Pollution Roses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-windRose.html"><a href="sec-windRose.html#example-of-use"><i class="fa fa-check"></i><b>5.1</b> Example of use</a></li>
<li class="chapter" data-level="5.2" data-path="sec-windRose.html"><a href="sec-windRose.html#sec:comp-met"><i class="fa fa-check"></i><b>5.2</b> Comparing two meteorological data sets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html"><i class="fa fa-check"></i><b>6</b> Polar frequencies</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-polarFreq.html"><a href="sec-polarFreq.html#sec:polarFreqBack"><i class="fa fa-check"></i><b>6.1</b> Background and examples</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html"><i class="fa fa-check"></i><b>7</b> Percentile roses</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#examples"><i class="fa fa-check"></i><b>7.2</b> Examples</a></li>
<li class="chapter" data-level="7.3" data-path="sec-percentileRose.html"><a href="sec-percentileRose.html#sec:CPF"><i class="fa fa-check"></i><b>7.3</b> Condtional probability function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html"><i class="fa fa-check"></i><b>8</b> Polar plots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#introduction-to-polar-plots"><i class="fa fa-check"></i><b>8.1</b> Introduction to polar plots</a></li>
<li class="chapter" data-level="8.2" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>8.2</b> Examples</a></li>
<li class="chapter" data-level="8.3" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#nonparametric-wind-regression-nwr"><i class="fa fa-check"></i><b>8.3</b> Nonparametric Wind Regression, NWR</a></li>
<li class="chapter" data-level="8.4" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#conditional-probability-function-cpf-plot"><i class="fa fa-check"></i><b>8.4</b> Conditional Probability Function (CPF) plot</a></li>
<li class="chapter" data-level="8.5" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#pairwise-statistics"><i class="fa fa-check"></i><b>8.5</b> Pairwise statistics</a></li>
<li class="chapter" data-level="8.6" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#sec:polarCluster"><i class="fa fa-check"></i><b>8.6</b> Clustering</a></li>
<li class="chapter" data-level="8.7" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plots-on-an-interactive-map"><i class="fa fa-check"></i><b>8.7</b> Polar plots on an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html"><i class="fa fa-check"></i><b>9</b> Polar annulus</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#polarAnnulusBack"><i class="fa fa-check"></i><b>9.1</b> Purpose</a></li>
<li class="chapter" data-level="9.2" data-path="sec-polarAnnulus.html"><a href="sec-polarAnnulus.html#sec:examAnnulus"><i class="fa fa-check"></i><b>9.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-timePlot.html"><a href="sec-timePlot.html"><i class="fa fa-check"></i><b>10</b> Time series plots</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-timePlot.html"><a href="sec-timePlot.html#sec:timePlotBack"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="sec-timePlot.html"><a href="sec-timePlot.html#examples-of-time-series-plotting"><i class="fa fa-check"></i><b>10.2</b> Examples of time series plotting</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html"><i class="fa fa-check"></i><b>11</b> Temporal variations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#sec:purpose-time-var"><i class="fa fa-check"></i><b>11.1</b> Purpose</a></li>
<li class="chapter" data-level="11.2" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#applications"><i class="fa fa-check"></i><b>11.2</b> Applications</a></li>
<li class="chapter" data-level="11.3" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>11.3</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sec-timeProp.html"><a href="sec-timeProp.html"><i class="fa fa-check"></i><b>12</b> Time proportion plots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropBack"><i class="fa fa-check"></i><b>12.1</b> Background</a></li>
<li class="chapter" data-level="12.2" data-path="sec-timeProp.html"><a href="sec-timeProp.html#sec:timePropEx"><i class="fa fa-check"></i><b>12.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html"><i class="fa fa-check"></i><b>13</b> Trend heat maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#another-way-of-representing-trends"><i class="fa fa-check"></i><b>13.1</b> Another way of representing trends</a></li>
<li class="chapter" data-level="13.2" data-path="sec-trendLevel.html"><a href="sec-trendLevel.html#sec:TrendLevelEx"><i class="fa fa-check"></i><b>13.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html"><i class="fa fa-check"></i><b>14</b> Calendar plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#purpose"><i class="fa fa-check"></i><b>14.1</b> Purpose</a></li>
<li class="chapter" data-level="14.2" data-path="sec-calendarPlot.html"><a href="sec-calendarPlot.html#calendar-examples"><i class="fa fa-check"></i><b>14.2</b> Calendar examples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html"><i class="fa fa-check"></i><b>15</b> Theil-Sen trends</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#trend-estimates"><i class="fa fa-check"></i><b>15.1</b> Trend estimates</a></li>
<li class="chapter" data-level="15.2" data-path="sec-TheilSen.html"><a href="sec-TheilSen.html#example-trend-analysis"><i class="fa fa-check"></i><b>15.2</b> Example trend analysis</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="sec-timeVariation.html"><a href="sec-timeVariation.html#output"><i class="fa fa-check"></i><b>15.2.1</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html"><i class="fa fa-check"></i><b>16</b> Smooth trends</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#sec:SmoothTrendInfo"><i class="fa fa-check"></i><b>16.1</b> Background</a></li>
<li class="chapter" data-level="16.2" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#examples-of-trend-analysis"><i class="fa fa-check"></i><b>16.2</b> Examples of trend analysis</a></li>
<li class="chapter" data-level="16.3" data-path="sec-smoothTrend.html"><a href="sec-smoothTrend.html#seasonal-averages"><i class="fa fa-check"></i><b>16.3</b> Seasonal averages</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html"><i class="fa fa-check"></i><b>17</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="17.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterPurpose"><i class="fa fa-check"></i><b>17.1</b> Purpose</a></li>
<li class="chapter" data-level="17.2" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:ScatterEx"><i class="fa fa-check"></i><b>17.2</b> Examples</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="sec-scatterPlot.html"><a href="sec-scatterPlot.html#sec:hexbin"><i class="fa fa-check"></i><b>17.2.1</b> Hexaganol binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html"><i class="fa fa-check"></i><b>18</b> Trajectory analysis</a>
<ul>
<li class="chapter" data-level="18.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#plotting-trajectories"><i class="fa fa-check"></i><b>18.1</b> Plotting trajectories</a></li>
<li class="chapter" data-level="18.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajLevel"><i class="fa fa-check"></i><b>18.2</b> Trajectory gridded frequencies</a></li>
<li class="chapter" data-level="18.3" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#trajectory-source-contribution-functions"><i class="fa fa-check"></i><b>18.3</b> Trajectory source contribution functions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#identifying-the-contribution-of-high-concentration-back-trajectories"><i class="fa fa-check"></i><b>18.3.1</b> Identifying the contribution of high concentration back trajectories</a></li>
<li class="chapter" data-level="18.3.2" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#allocating-trajectories-to-different-wind-sectors"><i class="fa fa-check"></i><b>18.3.2</b> Allocating trajectories to different wind sectors</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#potential-source-contribution-function-pscf"><i class="fa fa-check"></i><b>18.4</b> Potential Source Contribution Function (PSCF)</a></li>
<li class="chapter" data-level="18.5" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#concentration-weighted-trajectory-cwt"><i class="fa fa-check"></i><b>18.5</b> Concentration Weighted Trajectory (CWT)</a></li>
<li class="chapter" data-level="18.6" data-path="sec-trajPlot.html"><a href="sec-trajPlot.html#sec:trajCluster"><i class="fa fa-check"></i><b>18.6</b> Trajectory clustering</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html"><i class="fa fa-check"></i><b>19</b> Conditional quantiles</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalQuantileBack"><i class="fa fa-check"></i><b>19.1</b> Background</a></li>
<li class="chapter" data-level="19.2" data-path="sec-conditionalQuantile.html"><a href="sec-conditionalQuantile.html#sec:conditionalEval"><i class="fa fa-check"></i><b>19.2</b> Conditional evaluation</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sec-modStats.html"><a href="sec-modStats.html"><i class="fa fa-check"></i><b>20</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModBack"><i class="fa fa-check"></i><b>20.1</b> Background</a></li>
<li class="chapter" data-level="20.2" data-path="sec-modStats.html"><a href="sec-modStats.html#sec:ModEx"><i class="fa fa-check"></i><b>20.2</b> Example of use</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html"><i class="fa fa-check"></i><b>21</b> Taylor Diagam</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#sec:TaylorBack"><i class="fa fa-check"></i><b>21.1</b> Background</a></li>
<li class="chapter" data-level="21.2" data-path="sec-TaylorDiagram.html"><a href="sec-TaylorDiagram.html#examples-of-taylor-diagrams"><i class="fa fa-check"></i><b>21.2</b> Examples of Taylor Diagrams</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="sec-utility.html"><a href="sec-utility.html"><i class="fa fa-check"></i><b>22</b> Utility functions</a>
<ul>
<li class="chapter" data-level="22.1" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectByDate"><i class="fa fa-check"></i><b>22.1</b> Selecting data by date</a></li>
<li class="chapter" data-level="22.2" data-path="sec-utility.html"><a href="sec-utility.html#sec:cutData"><i class="fa fa-check"></i><b>22.2</b> Making intervals — cutData</a></li>
<li class="chapter" data-level="22.3" data-path="sec-utility.html"><a href="sec-utility.html#sec:selectRunning"><i class="fa fa-check"></i><b>22.3</b> Selecting run lengths of values above a threshold — pollution episodes</a></li>
<li class="chapter" data-level="22.4" data-path="sec-utility.html"><a href="sec-utility.html#sec:rollingMean"><i class="fa fa-check"></i><b>22.4</b> Calculating rolling means</a></li>
<li class="chapter" data-level="22.5" data-path="sec-utility.html"><a href="sec-utility.html#sec:timeAverage"><i class="fa fa-check"></i><b>22.5</b> Aggregating data by different time intervals</a></li>
<li class="chapter" data-level="22.6" data-path="sec-utility.html"><a href="sec-utility.html#sec:calcPercentile"><i class="fa fa-check"></i><b>22.6</b> Calculating percentiles</a></li>
<li class="chapter" data-level="22.7" data-path="sec-utility.html"><a href="sec-utility.html#sec:corPlot"><i class="fa fa-check"></i><b>22.7</b> Correlation matrices</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html"><i class="fa fa-check"></i><b>A</b> Annotating openair plots</a>
<ul>
<li class="chapter" data-level="A.1" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text"><i class="fa fa-check"></i><b>A.1</b> Adding text</a></li>
<li class="chapter" data-level="A.2" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-text-and-a-shaded-area"><i class="fa fa-check"></i><b>A.2</b> Adding text and a shaded area</a></li>
<li class="chapter" data-level="A.3" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-an-arrow"><i class="fa fa-check"></i><b>A.3</b> Adding an arrow</a></li>
<li class="chapter" data-level="A.4" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#adding-a-reference-line-and-text"><i class="fa fa-check"></i><b>A.4</b> Adding a reference line and text</a></li>
<li class="chapter" data-level="A.5" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#highlight-a-specific-point"><i class="fa fa-check"></i><b>A.5</b> Highlight a specific point</a></li>
<li class="chapter" data-level="A.6" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-a-filled-polygon"><i class="fa fa-check"></i><b>A.6</b> Add a filled polygon</a></li>
<li class="chapter" data-level="A.7" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#add-air-quality-bands-as-polygons"><i class="fa fa-check"></i><b>A.7</b> Add air quality bands as polygons</a></li>
<li class="chapter" data-level="A.8" data-path="sec-polarPlot.html"><a href="sec-polarPlot.html#polar-plot-examples"><i class="fa fa-check"></i><b>A.8</b> Polar plot examples</a></li>
<li class="chapter" data-level="A.9" data-path="annotating-openair-plots.html"><a href="annotating-openair-plots.html#using-grid-graphics-identify-locations-interactively"><i class="fa fa-check"></i><b>A.9</b> Using grid graphics — identify locations interactively</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="sec-prod-hyspl-traj.html"><a href="sec-prod-hyspl-traj.html"><i class="fa fa-check"></i><b>B</b> Production of HYSPLIT trajectory files</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The openair book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:scatterPlot" class="section level1" number="17">
<h1><span class="header-section-number">Section 17</span> Scatter plots</h1>
<div id="sec:ScatterPurpose" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Purpose</h2>
<p>Scatter plots are extremely useful and a very commonly used analysis
technique for considering how variables relate to one another. R does
of course have many capabilities for plotting data in this
way. However, it can be tricky to add linear relationships, or split
scatter plots by levels of other variables etc. The purpose of the
<code>scatterPlot</code> function is to make it straightforward to consider
how variables are related to one another in a way consistent with
other <span class="pkg">openair</span> functions. We have added several capabilities that can
be used just by setting different options, some of which are shown below.</p>
<p>There is less need for this function now that <span class="pkg">ggplot2</span> is available, but it still has some benefits for intercative use.</p>
<ul>
<li><p>A smooth fit is automatically added to help reveal the
underlying relationship between two variables together with the
estimated 95% confidence intervals of the fit. This is in general
an extremely useful thing to do because it helps to show the
(possibly) non-linear relationship between variables in a very
robust way — or indeed whether the relationship is linear.</p></li>
<li><p>It is easy to add a linear regression line. The resulting
equation is shown on the plot together with the R<span class="math inline">\(^2\)</span> value.</p></li>
<li><p>For large data sets there is the possibility to `bin’ the data
using hexagonal binning or kernel density estimates. This approach
is very useful when there is considerable over-plotting.</p></li>
<li><p>It is easy to show how two variables are related to one another
dependent on levels of a third variable. This capability is very
useful for exploring how different variables depend on one another
and can help reveal the underlying important relationships.</p></li>
<li><p>A plot of two variables can be colour-coded by a continuous
colour scale of a third variable.</p></li>
<li><p>It can handle date/time x-axis formats to provide an alternative
way of showing time series, which again can be colour-coded by a
third variable.</p></li>
</ul>
<p>The <code>scatterPlot</code> function isn’t really specific to atmospheric
sciences, in the same way as other plots. It is more a function for
convenience, written in a style that is consistent with other <span class="pkg">openair</span>
functions. Nevertheless, along with the <code>timePlot</code> function they
do form an important part of <span class="pkg">openair</span> because of the usefulness of
understanding show variables relate to one another. Furthermore, there
are many options to make it easy to explore data in an interactive way
without worrying about processing data or formatting plots.</p>
</div>
<div id="sec:ScatterEx" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Examples</h2>
<p>We provide a few examples of use and as usual, users are directed
towards the help pages (type <code>?scatterPlot</code>) for more extensive examples.</p>
<p>First we select a subset of data (2003) using the <span class="pkg">openair</span>
<code>selectByDate</code> function and plot NO<sub>x</sub> vs. NO<sub>2</sub> Figure
(<a href="sec-scatterPlot.html#fig:scatterPlot1">17.1</a>).</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="sec-scatterPlot.html#cb154-1" aria-hidden="true"></a>data2003 &lt;-<span class="st"> </span><span class="kw">selectByDate</span>(mydata, <span class="dt">year =</span> <span class="dv">2003</span>)</span>
<span id="cb154-2"><a href="sec-scatterPlot.html#cb154-2" aria-hidden="true"></a><span class="kw">scatterPlot</span>(data2003, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlot1"></span>
<img src="openair_files/figure-html/scatterPlot1-1.png" alt="Scatter plot of hourly NO~x~ vs. NO~2~ at Marylebone Road for 2003." width="50%" />
<p class="caption">
Figure 17.1: Scatter plot of hourly NO<sub>x</sub> vs. NO<sub>2</sub> at Marylebone Road for 2003.
</p>
</div>
<p>Often with several years of data, points are over-plotted and it can
be very difficult to see what the underlying relationship looks
like. One very effective method to use in these situations is to ‘bin’
the data and to colour the intervals by the number of counts of
occurrences in each bin. There are various ways of doing this, but
‘hexagonal binning’ is particularly effective because of the way
hexagons can be placed next to one another.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> To use hexagonal binning it will be
necessary to install the <span class="pkg">hexbin</span> package:</p>
<div id="sec:hexbin" class="section level3" number="17.2.1">
<h3><span class="header-section-number">17.2.1</span> Hexaganol binning</h3>
<p>Now it should be possible to make the plot by setting the method
option to <code>method = "hexbin"</code>, as shown in Figure
<a href="sec-scatterPlot.html#fig:scatterPlot2">17.2</a>. The benefit of hexagonal binning is that
it works equally well with enormous data sets e.g. several million
records. In this case Figure <a href="sec-scatterPlot.html#fig:scatterPlot2">17.2</a> provides a clearer
indication of the relationship between NO<sub>x</sub> and NO<sub>2</sub> than Figure
<a href="sec-scatterPlot.html#fig:scatterPlot1">17.1</a> because it reveals where most of the points
lie, which is not apparent from Figure <a href="sec-scatterPlot.html#fig:scatterPlot1">17.1</a>. Note that
For <code>method = "hexbin"</code> it can be useful to transform the scale if
it is dominated by a few very high values. This is possible by
supplying two functions: one that that applies the transformation and
the other that inverses it. For log scaling for example (the default),
<code>trans = function(x) log(x)</code> and <code>inv = function(x) exp(x)</code>. For
a square root transform use <code>trans = sqrt</code> and <code>inv =  function(x) x^2</code>. To not apply any transformation <code>trans = NULL</code>
and <code>inv = NULL</code> should be used.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="sec-scatterPlot.html#cb155-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(data2003, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;hexbin&quot;</span>, <span class="dt">col=</span> <span class="st">&quot;jet&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlot2"></span>
<img src="openair_files/figure-html/scatterPlot2-1.png" alt="Scatter plot of hourly NO~x~ vs. NO~2~ at Marylebone Road using hexagonal binning. The number of occurrences in each bin is colour-coded (not on a linear scale). It is now possible to see where most of the data lie and a better indication of the relationship between NO~x~ and NO~2~ is revealed." width="50%" />
<p class="caption">
Figure 17.2: Scatter plot of hourly NO<sub>x</sub> vs. NO<sub>2</sub> at Marylebone Road using hexagonal binning. The number of occurrences in each bin is colour-coded (not on a linear scale). It is now possible to see where most of the data lie and a better indication of the relationship between NO<sub>x</sub> and NO<sub>2</sub> is revealed.
</p>
</div>
<p>Note that when <code>method = "hexbin"</code> there are various options that
are useful e.g. a border around each bin and the number of bins. For
example, to place a grey border around each bin and set the bin size
try:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="sec-scatterPlot.html#cb156-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(mydata, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>, </span>
<span id="cb156-2"><a href="sec-scatterPlot.html#cb156-2" aria-hidden="true"></a>            <span class="dt">method =</span> <span class="st">&quot;hexbin&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;jet&quot;</span>,</span>
<span id="cb156-3"><a href="sec-scatterPlot.html#cb156-3" aria-hidden="true"></a>            <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">xbin =</span> <span class="dv">15</span>)</span></code></pre></div>
<p>The hexagonal binning and other binning methods are useful but often
the choice of bin size is somewhat arbitrary. Another useful approach
is to use a kernel density estimate to show where most points
lie. This is possible in <code>scatterPlot</code> with the <code>method =   "density"</code> option. Such a plot is shown in Figure
<a href="sec-scatterPlot.html#fig:scatterPlotDens">17.3</a>.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="sec-scatterPlot.html#cb157-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(<span class="kw">selectByDate</span>(mydata, <span class="dt">year =</span> <span class="dv">2003</span>),</span>
<span id="cb157-2"><a href="sec-scatterPlot.html#cb157-2" aria-hidden="true"></a>            <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>,</span>
<span id="cb157-3"><a href="sec-scatterPlot.html#cb157-3" aria-hidden="true"></a>            <span class="dt">method =</span> <span class="st">&quot;density&quot;</span>, </span>
<span id="cb157-4"><a href="sec-scatterPlot.html#cb157-4" aria-hidden="true"></a>            <span class="dt">cols =</span> <span class="st">&quot;jet&quot;</span>)</span></code></pre></div>
<pre><code>## (loaded the KernSmooth namespace)</code></pre>
<div class="figure"><span id="fig:scatterPlotDens"></span>
<img src="openair_files/figure-html/scatterPlotDens-1.png" alt="Scatter plot of hourly NO~x~ vs. NO~2~ at Marylebone Road using a kernel density estimate to show where most of the points lie. The *intensity* is a measure of how many points lie in a unit area of NO~x~ and NO~2~ concentration." width="55%" />
<p class="caption">
Figure 17.3: Scatter plot of hourly NO<sub>x</sub> vs. NO<sub>2</sub> at Marylebone Road using a kernel density estimate to show where most of the points lie. The <em>intensity</em> is a measure of how many points lie in a unit area of NO<sub>x</sub> and NO<sub>2</sub> concentration.
</p>
</div>
<p>Sometimes it is useful to consider how the relationship between two
variables varies by levels of a third. In <span class="pkg">openair</span> this approach is
possible by setting the option <code>type</code>. When <code>type</code> is another
numeric variables, four plots are produced for different quantiles of
that variable. We illustrate this point by considering how the
relationship between NO<sub>x</sub> and NO<sub>2</sub> varies with different levels of
O<sub>3</sub>. We also take the opportunity to not plot the smooth line, but
plot a linear fit instead and force the layout to be a 2 by 2 grid.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="sec-scatterPlot.html#cb159-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(data2003, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>, </span>
<span id="cb159-2"><a href="sec-scatterPlot.html#cb159-2" aria-hidden="true"></a>            <span class="dt">type =</span> <span class="st">&quot;o3&quot;</span>, <span class="dt">smooth =</span> <span class="ot">FALSE</span>,</span>
<span id="cb159-3"><a href="sec-scatterPlot.html#cb159-3" aria-hidden="true"></a>            <span class="dt">linear =</span> <span class="ot">TRUE</span>, <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlot3"></span>
<img src="openair_files/figure-html/scatterPlot3-1.png" alt="Scatter plot of hourly NO~x~ vs. NO~2~ at Marylebone Road by different levels of O~3~." width="65%" />
<p class="caption">
Figure 17.4: Scatter plot of hourly NO<sub>x</sub> vs. NO<sub>2</sub> at Marylebone Road by different levels of O<sub>3</sub>.
</p>
</div>
<p>Below is an extended example that brings together data manipulation, refined plot options and linear fitting of two variables with NO<sub>x</sub>. The aim is to plot the weekly concentration of NO<sub>x</sub> against PM<sub>10</sub> and PM<sub>2.5</sub> and fit linear equations to both relationships. To do this we need the <span class="math inline">\(x\)</span> variable as NO<sub>x</sub> and the <span class="math inline">\(y\)</span> variable as PM<sub>10</sub> or PM<sub>2.5</sub>, which means we also need a column that will act as a grouping column i.e. identifies whether the <span class="math inline">\(y\)</span> is PM<sub>10</sub> or PM<sub>2.5</sub>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="sec-scatterPlot.html#cb160-1" aria-hidden="true"></a><span class="co"># load the packages we need</span></span>
<span id="cb160-2"><a href="sec-scatterPlot.html#cb160-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb160-3"><a href="sec-scatterPlot.html#cb160-3" aria-hidden="true"></a></span>
<span id="cb160-4"><a href="sec-scatterPlot.html#cb160-4" aria-hidden="true"></a><span class="co"># select the variables of interest</span></span>
<span id="cb160-5"><a href="sec-scatterPlot.html#cb160-5" aria-hidden="true"></a>subdat &lt;-<span class="st"> </span><span class="kw">select</span>(mydata, date, nox, pm10, pm25) <span class="co"># calculate weekly averages</span></span>
<span id="cb160-6"><a href="sec-scatterPlot.html#cb160-6" aria-hidden="true"></a>subdat &lt;-<span class="st"> </span><span class="kw">timeAverage</span>(subdat, <span class="dt">avg.time =</span> <span class="st">&quot;week&quot;</span>)</span>
<span id="cb160-7"><a href="sec-scatterPlot.html#cb160-7" aria-hidden="true"></a></span>
<span id="cb160-8"><a href="sec-scatterPlot.html#cb160-8" aria-hidden="true"></a><span class="co"># reshape so we have two variable columns</span></span>
<span id="cb160-9"><a href="sec-scatterPlot.html#cb160-9" aria-hidden="true"></a>subdat &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(subdat, <span class="dt">cols =</span> <span class="kw">c</span>(pm10, pm25), </span>
<span id="cb160-10"><a href="sec-scatterPlot.html#cb160-10" aria-hidden="true"></a>                       <span class="dt">names_to =</span> <span class="st">&quot;pollutant&quot;</span>)</span>
<span id="cb160-11"><a href="sec-scatterPlot.html#cb160-11" aria-hidden="true"></a><span class="kw">head</span>(subdat)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   date                  nox pollutant value
##   &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 1997-12-29 00:00:00  128. pm10       21.8
## 2 1997-12-29 00:00:00  128. pm25      NaN  
## 3 1998-01-05 00:00:00  189. pm10       33.6
## 4 1998-01-05 00:00:00  189. pm25      NaN  
## 5 1998-01-12 00:00:00  203. pm10       29.1
## 6 1998-01-12 00:00:00  203. pm25      NaN</code></pre>
<p>Now we will plot weekly NO<sub>x</sub> versus PM<sub>10</sub> and PM<sub>2.5</sub> and fit a linear equation to both — and adjust some of the symbols (shown in Figure <a href="sec-scatterPlot.html#fig:scatterPlotTwo">17.5</a>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="sec-scatterPlot.html#cb162-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(subdat, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">group =</span> <span class="st">&quot;pollutant&quot;</span>, </span>
<span id="cb162-2"><a href="sec-scatterPlot.html#cb162-2" aria-hidden="true"></a>            <span class="dt">pch =</span> <span class="dv">21</span><span class="op">:</span><span class="dv">22</span>, <span class="dt">cex =</span> <span class="fl">1.6</span>, <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>), </span>
<span id="cb162-3"><a href="sec-scatterPlot.html#cb162-3" aria-hidden="true"></a>            <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb162-4"><a href="sec-scatterPlot.html#cb162-4" aria-hidden="true"></a>            <span class="dt">linear =</span> <span class="ot">TRUE</span>, </span>
<span id="cb162-5"><a href="sec-scatterPlot.html#cb162-5" aria-hidden="true"></a>            <span class="dt">xlab =</span> <span class="st">&quot;nox (ppb)&quot;</span>, </span>
<span id="cb162-6"><a href="sec-scatterPlot.html#cb162-6" aria-hidden="true"></a>            <span class="dt">ylab =</span> <span class="st">&quot;PM concentration (ug/m3)&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlotTwo"></span>
<img src="openair_files/figure-html/scatterPlotTwo-1.png" alt="Scatter plot of weekly NO~x~ vs. PM~10~ *and* PM~2.5~ at Marylebone Road with linear equations shown and plot symbols modified." width="67%" />
<p class="caption">
Figure 17.5: Scatter plot of weekly NO<sub>x</sub> vs. PM<sub>10</sub> <em>and</em> PM<sub>2.5</sub> at Marylebone Road with linear equations shown and plot symbols modified.
</p>
</div>
<p>To gain a better idea of where the data lie and the linear fits, adding some transparency helps:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="sec-scatterPlot.html#cb163-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(subdat, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;value&quot;</span>, </span>
<span id="cb163-2"><a href="sec-scatterPlot.html#cb163-2" aria-hidden="true"></a>            <span class="dt">group =</span> <span class="st">&quot;variable&quot;</span>, </span>
<span id="cb163-3"><a href="sec-scatterPlot.html#cb163-3" aria-hidden="true"></a>            <span class="dt">pch =</span> <span class="dv">21</span><span class="op">:</span><span class="dv">22</span>, <span class="dt">cex =</span> <span class="fl">1.6</span>, </span>
<span id="cb163-4"><a href="sec-scatterPlot.html#cb163-4" aria-hidden="true"></a>            <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>), </span>
<span id="cb163-5"><a href="sec-scatterPlot.html#cb163-5" aria-hidden="true"></a>            <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb163-6"><a href="sec-scatterPlot.html#cb163-6" aria-hidden="true"></a>            <span class="dt">linear =</span> <span class="ot">TRUE</span>, </span>
<span id="cb163-7"><a href="sec-scatterPlot.html#cb163-7" aria-hidden="true"></a>            <span class="dt">xlab =</span> <span class="st">&quot;nox (ppb)&quot;</span>, </span>
<span id="cb163-8"><a href="sec-scatterPlot.html#cb163-8" aria-hidden="true"></a>            <span class="dt">ylab =</span> <span class="st">&quot;PM concentration (ug/m3)&quot;</span>,</span>
<span id="cb163-9"><a href="sec-scatterPlot.html#cb163-9" aria-hidden="true"></a>            <span class="dt">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p>The above example will also work with <code>type</code>. For example, to consider how NO<sub>x</sub> againts PM<sub>10</sub> and PM<sub>2.5</sub> varies by season:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="sec-scatterPlot.html#cb164-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(subdat, <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;value&quot;</span>, </span>
<span id="cb164-2"><a href="sec-scatterPlot.html#cb164-2" aria-hidden="true"></a>            <span class="dt">group =</span> <span class="st">&quot;variable&quot;</span>, </span>
<span id="cb164-3"><a href="sec-scatterPlot.html#cb164-3" aria-hidden="true"></a>            <span class="dt">pch =</span> <span class="dv">21</span><span class="op">:</span><span class="dv">22</span>, <span class="dt">cex =</span> <span class="dv">2</span>, </span>
<span id="cb164-4"><a href="sec-scatterPlot.html#cb164-4" aria-hidden="true"></a>            <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>), </span>
<span id="cb164-5"><a href="sec-scatterPlot.html#cb164-5" aria-hidden="true"></a>            <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linear =</span> <span class="ot">TRUE</span>, </span>
<span id="cb164-6"><a href="sec-scatterPlot.html#cb164-6" aria-hidden="true"></a>            <span class="dt">xlab =</span> <span class="st">&quot;nox (ppb)&quot;</span>, </span>
<span id="cb164-7"><a href="sec-scatterPlot.html#cb164-7" aria-hidden="true"></a>            <span class="dt">ylab =</span> <span class="st">&quot;PM concentration (ug/m3)&quot;</span>, </span>
<span id="cb164-8"><a href="sec-scatterPlot.html#cb164-8" aria-hidden="true"></a>            <span class="dt">type =</span> <span class="st">&quot;season&quot;</span>)</span></code></pre></div>
<p>Finally, we show how to plot a continuous colour scale for a third
<em>numeric</em> variable setting the value of <code>z</code> to the third
variable. Figure <a href="sec-scatterPlot.html#fig:scatterPlot4">17.6</a> shows again the relationship
between NO<sub>x</sub> and NO<sub>2</sub> but this time colour-coded by the
concentration of O<sub>3</sub>. We also take the opportunity to split the
data into seasons and weekday/weekend by setting <code>type =   c("season", "weekend")</code>. There is an enormous amount of information
that can be gained from plots such as this. Differences between
weekdays and the weekend can highlight changes in emission sources,
splitting by seasons can show seasonal influences in meteorology and
background O<sub>3</sub> and colouring the data by the concentration of
O<sub>3</sub> helps to show how O<sub>3</sub> concentrations affect NO<sub>2</sub>
concentrations. For example, consider the summertime-weekday panel
where it clearly shows that the higher NO<sub>2</sub> concentrations are
associated with high O<sub>3</sub> concentrations. Indeed there are some
hours where NO<sub>2</sub> is &gt;100 ppb at quite low concentrations of NO<sub>x</sub>
(<span class="math inline">\(\approx\)</span> 200 ppb). It would also be interesting instead of using
O<sub>3</sub> concentrations from Marylebone Road to use O<sub>3</sub> from a
background site.</p>
<p>Figure <a href="sec-scatterPlot.html#fig:scatterPlot4">17.6</a> was very easily produced
but contains a huge amount of useful information showing the
relationship between NO<sub>x</sub> and NO<sub>2</sub> dependent upon the concentration
of O<sub>3</sub>, the season and the day of the week. There are of course
numerous other plots that are equally easily produced.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="sec-scatterPlot.html#cb165-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(data2003, </span>
<span id="cb165-2"><a href="sec-scatterPlot.html#cb165-2" aria-hidden="true"></a>            <span class="dt">x =</span> <span class="st">&quot;nox&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">z =</span> <span class="st">&quot;o3&quot;</span>, </span>
<span id="cb165-3"><a href="sec-scatterPlot.html#cb165-3" aria-hidden="true"></a>            <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;weekend&quot;</span>),</span>
<span id="cb165-4"><a href="sec-scatterPlot.html#cb165-4" aria-hidden="true"></a>            <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlot4"></span>
<img src="openair_files/figure-html/scatterPlot4-1.png" alt="Scatter plot of hourly NO~x~ vs. NO~2~ at Marylebone Road by different levels of O~3~ split by season and weekday-weekend." width="960" />
<p class="caption">
Figure 17.6: Scatter plot of hourly NO<sub>x</sub> vs. NO<sub>2</sub> at Marylebone Road by different levels of O<sub>3</sub> split by season and weekday-weekend.
</p>
</div>
<p>Figure <a href="sec-scatterPlot.html#fig:scatterPlot5">17.7</a> shows that <code>scatterPlot</code> can also
handles dates on the x-axis; in this case shown for SO<sub>2</sub>
concentrations coloured by wind direction for August 2003.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="sec-scatterPlot.html#cb166-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(<span class="kw">selectByDate</span>(data2003, <span class="dt">month =</span> <span class="dv">8</span>), </span>
<span id="cb166-2"><a href="sec-scatterPlot.html#cb166-2" aria-hidden="true"></a>            <span class="dt">x =</span> <span class="st">&quot;date&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;so2&quot;</span>,</span>
<span id="cb166-3"><a href="sec-scatterPlot.html#cb166-3" aria-hidden="true"></a>             <span class="dt">z =</span> <span class="st">&quot;wd&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlot5"></span>
<img src="openair_files/figure-html/scatterPlot5-1.png" alt="Scatter plot of date vs. SO~2~- at Marylebone Road by different levels of wind direction for August 2003." width="65%" />
<p class="caption">
Figure 17.7: Scatter plot of date vs. SO<sub>2</sub>- at Marylebone Road by different levels of wind direction for August 2003.
</p>
</div>
<p>Similar to Section <a href="sec-timePlot.html#sec:timePlot">10</a>, <code>scatterPlot</code> can
also plot wind vector arrows if wind speed and wind direction are
available in the data frame. Figure <a href="sec-scatterPlot.html#fig:scatterPlotwswd">17.8</a> shows an
example of using the <code>windflow</code> option. The Figure also sets many
other options including showing the concentration of O<sub>3</sub> as a
colour, setting the colour scale used and selecting a few days of
interest using the <code>selectByDate</code>
function. Figure <a href="sec-scatterPlot.html#fig:scatterPlotwswd">17.8</a> shows that when the wind
direction changes to northerly, the concentration of NO<sub>2</sub> decreases
and that of O<sub>3</sub> increases.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="sec-scatterPlot.html#cb167-1" aria-hidden="true"></a><span class="kw">scatterPlot</span>(<span class="kw">selectByDate</span>(mydata, <span class="dt">start =</span> <span class="st">&quot;1/6/2001&quot;</span>, </span>
<span id="cb167-2"><a href="sec-scatterPlot.html#cb167-2" aria-hidden="true"></a>                         <span class="dt">end =</span> <span class="st">&quot;5/6/2001&quot;</span>), </span>
<span id="cb167-3"><a href="sec-scatterPlot.html#cb167-3" aria-hidden="true"></a>            <span class="dt">x =</span> <span class="st">&quot;date&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;no2&quot;</span>, <span class="dt">z =</span> <span class="st">&quot;o3&quot;</span>, </span>
<span id="cb167-4"><a href="sec-scatterPlot.html#cb167-4" aria-hidden="true"></a>            <span class="dt">col =</span> <span class="st">&quot;increment&quot;</span>, </span>
<span id="cb167-5"><a href="sec-scatterPlot.html#cb167-5" aria-hidden="true"></a>            <span class="dt">windflow =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="fl">0.15</span>), </span>
<span id="cb167-6"><a href="sec-scatterPlot.html#cb167-6" aria-hidden="true"></a>            <span class="dt">key.footer =</span> <span class="st">&quot;o3</span><span class="ch">\n</span><span class="st"> (ppb)&quot;</span>, </span>
<span id="cb167-7"><a href="sec-scatterPlot.html#cb167-7" aria-hidden="true"></a>            <span class="dt">main =</span> <span class="ot">NULL</span>, <span class="dt">ylab =</span> <span class="st">&quot;no2 (ppb)&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:scatterPlotwswd"></span>
<img src="openair_files/figure-html/scatterPlotwswd-1.png" alt="Scatter plot of date vs. NO~2~ with the colour scale representing O~3~. The wind flow vectors are also shown." width="65%" />
<p class="caption">
Figure 17.8: Scatter plot of date vs. NO<sub>2</sub> with the colour scale representing O<sub>3</sub>. The wind flow vectors are also shown.
</p>
</div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>In fact it is not
possible to have a shape with more than 6 sides that can be used to
forma a lattice without gaps.<a href="sec-scatterPlot.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-smoothTrend.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-trajPlot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/davidcarslaw/openair-book/edit/master/scatter-plot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
